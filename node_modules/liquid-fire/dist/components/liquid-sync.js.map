{"version":3,"file":"liquid-sync.js","sources":["../../src/components/liquid-sync.hbs.js","../../src/components/liquid-sync.js"],"sourcesContent":["import { precompileTemplate } from \"@ember/template-compilation\";\nexport default precompileTemplate(\"{{yield (action \\\"ready\\\")~}}\\r\\n<div class=\\\"liquid-sync\\\"\\r\\n\t{{did-insert this.setup}}\\r\\n\t{{will-destroy this.destroyElement}}\\r\\n></div>\")","import Component from '@glimmer/component';\r\nimport { action } from '@ember/object';\r\nimport { defer } from 'rsvp';\r\nimport { inject as service } from '@ember/service';\r\nimport './liquid-sync.css';\r\n\r\nexport default class LiquidSyncComponent extends Component {\r\n  @service liquidFireChildren;\r\n  @service('liquid-fire-transitions') _transitionMap;\r\n\r\n  _lfDefer = [];\r\n\r\n  @action\r\n  setup(element) {\r\n    this.element = element;\r\n    this.pauseLiquidFire();\r\n  }\r\n\r\n  @action\r\n  destroyElement() {\r\n    this.ready();\r\n  }\r\n\r\n  @action\r\n  ready() {\r\n    this.resumeLiquidFire();\r\n  }\r\n\r\n  pauseLiquidFire() {\r\n    const context = this.liquidFireChildren.closest(this.element);\r\n    if (context) {\r\n      const def = new defer();\r\n      const tmap = this._transitionMap;\r\n      tmap.incrementRunningTransitions();\r\n      def.promise.finally(() => tmap.decrementRunningTransitions());\r\n      this._lfDefer.push(def);\r\n      context._waitForMe(def.promise);\r\n    }\r\n  }\r\n\r\n  @action\r\n  resumeLiquidFire() {\r\n    const def = this._lfDefer.pop();\r\n    if (def) {\r\n      def.resolve();\r\n    }\r\n  }\r\n}\r\n"],"names":["precompileTemplate","LiquidSyncComponent","_dec","service","_class","Component","constructor","args","_initializerDefineProperty","_descriptor","_descriptor2","_defineProperty","setup","element","pauseLiquidFire","destroyElement","ready","resumeLiquidFire","context","liquidFireChildren","closest","def","defer","tmap","_transitionMap","incrementRunningTransitions","promise","finally","decrementRunningTransitions","_lfDefer","push","_waitForMe","pop","resolve","_applyDecoratedDescriptor","prototype","configurable","enumerable","writable","initializer","action","Object","getOwnPropertyDescriptor","setComponentTemplate","TEMPLATE"],"mappings":"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"}