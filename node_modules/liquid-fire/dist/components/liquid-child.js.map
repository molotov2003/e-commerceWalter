{"version":3,"file":"liquid-child.js","sources":["../../src/components/liquid-child.hbs.js","../../src/components/liquid-child.js"],"sourcesContent":["import { precompileTemplate } from \"@ember/template-compilation\";\nexport default precompileTemplate(\"<div class=\\\"liquid-child {{@class}}\\\" data-liquid-child={{@uniqueChildId}}\\r\\n   ...attributes\\r\\n  {{did-insert this.setup}}\\r\\n  {{will-destroy this.destroyElement}}\\r\\n>\\r\\n  {{~yield~}}\\r\\n</div>\")","import Component from '@glimmer/component';\r\nimport { action } from '@ember/object';\r\nimport { inject as service } from '@ember/service';\r\nimport { all } from 'rsvp';\r\nimport './liquid-child.css';\r\n\r\nexport default class LiquidChildComponent extends Component {\r\n  @service liquidFireChildren;\r\n\r\n  element = null;\r\n  _waitingFor = [];\r\n  _isLiquidChild = true;\r\n  _serviceElement = null;\r\n\r\n  @action\r\n  setup(element) {\r\n    this.element = element;\r\n\r\n    this._serviceElement = this.liquidFireChildren.register(\r\n      this.args.uniqueChildId,\r\n      this,\r\n    );\r\n\r\n    element.style.visibility = 'hidden';\r\n\r\n    this._waitForAll().then(() => {\r\n      if (!this.isDestroying) {\r\n        this.liquidFireChildren._waitingFor = [];\r\n        const didRenderAction = this.args.liquidChildDidRender;\r\n        if (typeof didRenderAction === 'function') {\r\n          didRenderAction(this);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  @action\r\n  destroyElement() {\r\n    if (this._serviceElement) {\r\n      this.liquidFireChildren.unregister(this._serviceElement);\r\n      this._serviceElement = null;\r\n    }\r\n  }\r\n\r\n  _waitForMe(promise) {\r\n    if (!this.liquidFireChildren._waitingFor) {\r\n      return;\r\n    }\r\n    this.liquidFireChildren._waitingFor.push(promise);\r\n    const ancestor = this.liquidFireChildren.closest(this.element);\r\n    if (ancestor) {\r\n      ancestor._waitForMe(promise);\r\n    }\r\n  }\r\n\r\n  _waitForAll() {\r\n    const promises = this.liquidFireChildren._waitingFor;\r\n    this.liquidFireChildren._waitingFor = [];\r\n    return all(promises).then(() => {\r\n      if (this.liquidFireChildren._waitingFor.length > 0) {\r\n        return this._waitForAll();\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"names":["precompileTemplate","LiquidChildComponent","_class","Component","constructor","args","_initializerDefineProperty","_descriptor","_defineProperty","setup","element","_serviceElement","liquidFireChildren","register","uniqueChildId","style","visibility","_waitForAll","then","isDestroying","_waitingFor","didRenderAction","liquidChildDidRender","destroyElement","unregister","_waitForMe","promise","push","ancestor","closest","promises","all","length","_applyDecoratedDescriptor","prototype","service","configurable","enumerable","writable","initializer","action","Object","getOwnPropertyDescriptor","setComponentTemplate","TEMPLATE"],"mappings":"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"}