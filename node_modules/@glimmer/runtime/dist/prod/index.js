import{debug as e,logOpcode as t,recordStackSize as n,opcodeMetadata as s,check as i,CheckPrimitive as r,CheckNumber as a,CheckOption as o,CheckHandle as l,CheckBlockSymbolTable as c,CheckInstanceof as u,CheckString as d,CheckElement as h,CheckMaybe as p,CheckNode as m,CheckOr as f,CheckProgramSymbolTable as g,CheckInterface as b,CheckFunction as v,wrap as y,CheckArray as k,CheckDict as w,CheckUnknown as S,CheckObject as E,CheckSafeString as x,CheckDocumentFragment as C}from"@glimmer/debug";import{UNDEFINED_REFERENCE as N,valueForRef as T,createComputeRef as _,createConstRef as B,createPrimitiveRef as A,isConstRef as M,NULL_REFERENCE as R,TRUE_REFERENCE as O,FALSE_REFERENCE as L,REFERENCE as D,createDebugAliasRef as V,childRefFor as U,createIteratorRef as I,isInvokableRef as $,updateRef as H,createIteratorItemRef as P}from"@glimmer/reference";import{assign as G,unwrap as j,expect as F,NS_SVG as z,castToBrowser as W,Stack as Y,assert as J,fillNulls as q,LOCAL_LOGGER as K,isObject as X,decodeHandle as Q,isHandle as Z,decodeImmediate as ee,debugToString as te,EMPTY_STRING_ARRAY as ne,dict as se,unwrapTemplate as ie,enumerate as re,emptyArray as ae,INSERT_BEFORE_END as oe,INSERT_BEFORE_BEGIN as le,clearElement as ce,INSERT_AFTER_BEGIN as ue,castToSimple as de,buildUntouchableThis as he,isDict as pe,logStep as me,unwrapHandle as fe,reverse as ge,COMMENT_NODE as be}from"@glimmer/util";import{Op as ve,$pc as ye,$sp as ke,$ra as we,$fp as Se,CurriedTypes as Ee,$t0 as xe,$t1 as Ce,InternalComponentCapabilities as Ne,$v0 as Te,ContentType as _e,CurriedType as Be,MachineOp as Ae,isLowLevelRegister as Me,$s1 as Re,$s0 as Oe}from"@glimmer/vm";import{registerDestructor as Le,destroy as De,associateDestroyableChild as Ve,_hasDestroyableChildren as Ue,isDestroying as Ie,isDestroyed as $e,destroyChildren as He}from"@glimmer/destroyable";export{destroy,isDestroyed,isDestroying,registerDestructor}from"@glimmer/destroyable";import{warnIfStyleNotTrusted as Pe,toBool as Ge,getPath as je,setPath as Fe,deprecate as ze,assertGlobalContextWasSet as We}from"@glimmer/global-context";import{beginTrackFrame as Ye,endTrackFrame as Je,CONSTANT_TAG as qe,INITIAL as Ke,validateTag as Xe,consumeTag as Qe,valueForTag as Ze,CURRENT_TAG as et,COMPUTE as tt,track as nt,updateTag as st,createCache as it,getValue as rt,createUpdatableTag as at,debug as ot,resetTracking as lt}from"@glimmer/validator";import{managerHasCapability as ct,hasInternalComponentManager as ut,hasInternalHelperManager as dt,setInternalComponentManager as ht,setInternalHelperManager as pt,getInternalHelperManager as mt,hasValue as ft,hasDestroyable as gt,setInternalModifierManager as bt}from"@glimmer/manager";import{RuntimeProgramImpl as vt}from"@glimmer/program";import{getOwner as yt}from"@glimmer/owner";const kt=!("undefined"!=typeof window&&window.location&&/[&?]disable_local_debug/u.test(window.location.search)),wt=!("undefined"==typeof window||!window.location||!/[&?]enable_local_should_log/u.test(window.location.search));class St{bucket;constructor(e){this.bucket=e?G({},e):{}}get(e){return j(this.bucket[e])}set(e,t){return this.bucket[e]=t}child(){return new St(this.bucket)}}class Et{static root(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,s=new Array(t+1);for(let e=0;e<=t;e++)s[e]=N;return new Et(s,n,null,null,null).init({self:e})}static sized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=new Array(e+1);for(let t=0;t<=e;t++)n[t]=N;return new Et(n,t,null,null,null)}constructor(e,t,n,s,i){this.slots=e,this.owner=t,this.callerScope=n,this.evalScope=s,this.partialMap=i}init(e){let{self:t}=e;return this.slots[0]=t,this}getSelf(){return this.get(0)}getSymbol(e){return this.get(e)}getBlock(e){let t=this.get(e);return t===N?null:t}getEvalScope(){return this.evalScope}getPartialMap(){return this.partialMap}bind(e,t){this.set(e,t)}bindSelf(e){this.set(0,e)}bindSymbol(e,t){this.set(e,t)}bindBlock(e,t){this.set(e,t)}bindEvalScope(e){this.evalScope=e}bindPartialMap(e){this.partialMap=e}bindCallerScope(e){this.callerScope=e}getCallerScope(){return this.callerScope}child(){return new Et(this.slots.slice(),this.owner,this.callerScope,this.evalScope,this.partialMap)}get(e){if(e>=this.slots.length)throw new RangeError(`BUG: cannot get $${e} from scope; length=${this.slots.length}`);return this.slots[e]}set(e,t){if(e>=this.slots.length)throw new RangeError(`BUG: cannot get $${e} from scope; length=${this.slots.length}`);this.slots[e]=t}}const xt=Symbol("INNER_VM"),Ct=Symbol("DESTROYABLE_STACK"),Nt=Symbol("STACKS"),Tt=Symbol("REGISTERS"),_t=Symbol("HEAP"),Bt=Symbol("CONSTANTS"),At=Symbol("ARGS");class Mt{constructor(e,t){this.element=e,this.nextSibling=t}}class Rt{constructor(e,t,n){this.parentNode=e,this.first=t,this.last=n}parentElement(){return this.parentNode}firstNode(){return this.first}lastNode(){return this.last}}class Ot{constructor(e,t){this.parentNode=e,this.node=t}parentElement(){return this.parentNode}firstNode(){return this.node}lastNode(){return this.node}}function Lt(e,t){let n=e.parentElement(),s=e.firstNode(),i=e.lastNode(),r=s;for(;;){let e=r.nextSibling;if(n.insertBefore(r,t),r===i)return e;r=F(e,"invalid bounds")}}function Dt(e){let t=e.parentElement(),n=e.firstNode(),s=e.lastNode(),i=n;for(;;){let e=i.nextSibling;if(t.removeChild(i),i===s)return e;i=F(e,"invalid bounds")}}function Vt(e){return Ut(e)?"":String(e)}function Ut(e){return null==e||"function"!=typeof e.toString}function It(e){return"object"==typeof e&&null!==e&&"function"==typeof e.toHTML}function $t(e){return"object"==typeof e&&null!==e&&"number"==typeof e.nodeType}function Ht(e){return"string"==typeof e}function Pt(e,t){let n,s;if(t in e)s=t,n="prop";else{let i=t.toLowerCase();i in e?(n="prop",s=i):(n="attr",s=t)}return"prop"!==n||"style"!==s.toLowerCase()&&!function(e,t){let n=Gt[e.toUpperCase()];return n&&n[t.toLowerCase()]||!1}(e.tagName,s)||(n="attr"),{normalized:s,type:n}}const Gt={INPUT:{form:!0,autocorrect:!0,list:!0},SELECT:{form:!0},OPTION:{form:!0},TEXTAREA:{form:!0},LABEL:{form:!0},FIELDSET:{form:!0},LEGEND:{form:!0},OBJECT:{form:!0},OUTPUT:{form:!0},BUTTON:{form:!0}};const jt=["javascript:","vbscript:"],Ft=["A","BODY","LINK","IMG","IFRAME","BASE","FORM"],zt=["EMBED"],Wt=["href","src","background","action"],Yt=["src"];function Jt(e,t){return-1!==e.indexOf(t)}function qt(e,t){return(null===e||Jt(Ft,e))&&Jt(Wt,t)}function Kt(e,t){return null!==e&&(Jt(zt,e)&&Jt(Yt,t))}function Xt(e,t){return qt(e,t)||Kt(e,t)}let Qt,Zt;if("object"==typeof URL&&null!==URL&&"function"==typeof URL.parse){let e=URL;Qt=t=>{let n=null;return"string"==typeof t&&(n=e.parse(t).protocol),null===n?":":n}}else if("function"==typeof URL)Qt=e=>{try{return new URL(e).protocol}catch(e){return":"}};else{let e=document.createElement("a");Qt=t=>(e.href=t,e.protocol)}function en(e,t,n){let s=null;if(null==n)return n;if(It(n))return n.toHTML();s=e?e.tagName.toUpperCase():null;let i=Vt(n);if(qt(s,t)){let e=Qt(i);if(Jt(jt,e))return`unsafe:${i}`}return Kt(s,t)?`unsafe:${i}`:i}function tn(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const{tagName:i,namespaceURI:r}=e,a={element:e,name:t,namespace:n};if("style"===t&&!s)return new Zt(a);if(r===z)return nn(i,t,a);const{type:o,normalized:l}=Pt(e,t);return"attr"===o?nn(i,l,a):function(e,t,n){if(Xt(e,t))return new on(t,n);if(function(e,t){return("INPUT"===e||"TEXTAREA"===e)&&"value"===t}(e,t))return new cn(t,n);if(function(e,t){return"OPTION"===e&&"selected"===t}(e,t))return new un(t,n);return new an(t,n)}(i,l,a)}function nn(e,t,n){return Xt(e,t)?new ln(n):new rn(n)}class sn{constructor(e){this.attribute=e}}class rn extends sn{set(e,t,n){const s=dn(t);if(null!==s){const{name:t,namespace:n}=this.attribute;e.__setAttribute(t,s,n)}}update(e,t){const n=dn(e),{element:s,name:i}=this.attribute;null===n?s.removeAttribute(i):s.setAttribute(i,n)}}class an extends sn{constructor(e,t){super(t),this.normalizedName=e}value;set(e,t,n){null!=t&&(this.value=t,e.__setProperty(this.normalizedName,t))}update(e,t){const{element:n}=this.attribute;this.value!==e&&(n[this.normalizedName]=this.value=e,null==e&&this.removeAttribute())}removeAttribute(){const{element:e,namespace:t}=this.attribute;t?e.removeAttributeNS(t,this.normalizedName):e.removeAttribute(this.normalizedName)}}class on extends an{set(e,t,n){const{element:s,name:i}=this.attribute,r=en(s,i,t);super.set(e,r,n)}update(e,t){const{element:n,name:s}=this.attribute,i=en(n,s,e);super.update(i,t)}}class ln extends rn{set(e,t,n){const{element:s,name:i}=this.attribute,r=en(s,i,t);super.set(e,r,n)}update(e,t){const{element:n,name:s}=this.attribute,i=en(n,s,e);super.update(i,t)}}class cn extends an{set(e,t){e.__setProperty("value",Vt(t))}update(e){const t=W(this.attribute.element,["input","textarea"]),n=t.value,s=Vt(e);n!==s&&(t.value=s)}}class un extends an{set(e,t){null!=t&&!1!==t&&e.__setProperty("selected",!0)}update(e){const t=W(this.attribute.element,"option");t.selected=!!e}}function dn(e){return!1===e||null==e||void 0===e.toString?null:!0===e?"":"function"==typeof e?null:String(e)}Zt=class extends rn{set(e,t,n){Pe(t),super.set(e,t,n)}update(e,t){Pe(e),super.update(e,t)}};class hn{constructor(e){this.node=e}firstNode(){return this.node}}class pn{constructor(e){this.node=e}lastNode(){return this.node}}const mn=Symbol("CURSOR_STACK");class fn{dom;updateOperations;constructing=null;operations=null;env;[mn]=new Y;modifierStack=new Y;blockStack=new Y;static forInitialRender(e,t){return new this(e,t.element,t.nextSibling).initialize()}static resume(e,t){let n=new this(e,t.parentElement(),t.reset(e)).initialize();return n.pushLiveBlock(t),n}constructor(e,t,n){this.pushElement(t,n),this.env=e,this.dom=e.getAppendOperations(),this.updateOperations=e.getDOM()}initialize(){return this.pushSimpleBlock(),this}debugBlocks(){return this.blockStack.toArray()}get element(){return this[mn].current.element}get nextSibling(){return this[mn].current.nextSibling}get hasBlocks(){return this.blockStack.size>0}block(){return F(this.blockStack.current,"Expected a current live block")}popElement(){this[mn].pop(),F(this[mn].current,"can't pop past the last element")}pushSimpleBlock(){return this.pushLiveBlock(new gn(this.element))}pushUpdatableBlock(){return this.pushLiveBlock(new vn(this.element))}pushBlockList(e){return this.pushLiveBlock(new yn(this.element,e))}pushLiveBlock(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.blockStack.current;return null!==n&&(t||n.didAppendBounds(e)),this.__openBlock(),this.blockStack.push(e),e}popBlock(){return this.block().finalize(this),this.__closeBlock(),F(this.blockStack.pop(),"Expected popBlock to return a block")}__openBlock(){}__closeBlock(){}openElement(e){let t=this.__openElement(e);return this.constructing=t,t}__openElement(e){return this.dom.createElement(e,this.element)}flushElement(e){let t=this.element,n=F(this.constructing,"flushElement should only be called when constructing an element");this.__flushElement(t,n),this.constructing=null,this.operations=null,this.pushModifiers(e),this.pushElement(n,null),this.didOpenElement(n)}__flushElement(e,t){this.dom.insertBefore(e,t,this.nextSibling)}closeElement(){return this.willCloseElement(),this.popElement(),this.popModifiers()}pushRemoteElement(e,t,n){return this.__pushRemoteElement(e,t,n)}__pushRemoteElement(e,t,n){if(this.pushElement(e,n),void 0===n)for(;e.lastChild;)e.removeChild(e.lastChild);let s=new bn(e);return this.pushLiveBlock(s,!0)}popRemoteElement(){this.popBlock(),this.popElement()}pushElement(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this[mn].push(new Mt(e,t))}pushModifiers(e){this.modifierStack.push(e)}popModifiers(){return this.modifierStack.pop()}didAppendBounds(e){return this.block().didAppendBounds(e),e}didAppendNode(e){return this.block().didAppendNode(e),e}didOpenElement(e){return this.block().openElement(e),e}willCloseElement(){this.block().closeElement()}appendText(e){return this.didAppendNode(this.__appendText(e))}__appendText(e){let{dom:t,element:n,nextSibling:s}=this,i=t.createTextNode(e);return t.insertBefore(n,i,s),i}__appendNode(e){return this.dom.insertBefore(this.element,e,this.nextSibling),e}__appendFragment(e){let t=e.firstChild;if(t){let n=new Rt(this.element,t,e.lastChild);return this.dom.insertBefore(this.element,e,this.nextSibling),n}return new Ot(this.element,this.__appendComment(""))}__appendHTML(e){return this.dom.insertHTMLBefore(this.element,this.nextSibling,e)}appendDynamicHTML(e){let t=this.trustedContent(e);this.didAppendBounds(t)}appendDynamicText(e){let t=this.untrustedContent(e);return this.didAppendNode(t),t}appendDynamicFragment(e){let t=this.__appendFragment(e);this.didAppendBounds(t)}appendDynamicNode(e){let t=this.__appendNode(e),n=new Ot(this.element,t);this.didAppendBounds(n)}trustedContent(e){return this.__appendHTML(e)}untrustedContent(e){return this.__appendText(e)}appendComment(e){return this.didAppendNode(this.__appendComment(e))}__appendComment(e){let{dom:t,element:n,nextSibling:s}=this,i=t.createComment(e);return t.insertBefore(n,i,s),i}__setAttribute(e,t,n){this.dom.setAttribute(this.constructing,e,t,n)}__setProperty(e,t){this.constructing[e]=t}setStaticAttribute(e,t,n){this.__setAttribute(e,t,n)}setDynamicAttribute(e,t,n,s){let i=tn(this.constructing,e,s,n);return i.set(this,t,this.env),i}}class gn{first=null;last=null;nesting=0;constructor(e){this.parent=e}parentElement(){return this.parent}firstNode(){return F(this.first,"cannot call `firstNode()` while `SimpleLiveBlock` is still initializing").firstNode()}lastNode(){return F(this.last,"cannot call `lastNode()` while `SimpleLiveBlock` is still initializing").lastNode()}openElement(e){this.didAppendNode(e),this.nesting++}closeElement(){this.nesting--}didAppendNode(e){0===this.nesting&&(this.first||(this.first=new hn(e)),this.last=new pn(e))}didAppendBounds(e){0===this.nesting&&(this.first||(this.first=e),this.last=e)}finalize(e){null===this.first&&e.appendComment("")}}class bn extends gn{constructor(e){super(e),Le(this,(()=>{this.parentElement()===this.firstNode().parentNode&&Dt(this)}))}}class vn extends gn{reset(){De(this);let e=Dt(this);return this.first=null,this.last=null,this.nesting=0,e}}class yn{constructor(e,t){this.parent=e,this.boundList=t,this.parent=e,this.boundList=t}parentElement(){return this.parent}firstNode(){return F(this.boundList[0],"cannot call `firstNode()` while `LiveBlockList` is still initializing").firstNode()}lastNode(){let e=this.boundList;return F(e[e.length-1],"cannot call `lastNode()` while `LiveBlockList` is still initializing").lastNode()}openElement(e){J(!1,"Cannot openElement directly inside a block list")}closeElement(){J(!1,"Cannot closeElement directly inside a block list")}didAppendNode(e){J(!1,"Cannot create a new node directly inside a block list")}didAppendBounds(e){}finalize(e){J(this.boundList.length>0,"boundsList cannot be empty")}}function kn(e,t){return fn.forInitialRender(e,t)}const wn=new class{evaluateOpcode=q(ve.Size).slice();add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"syscall";this.evaluateOpcode[e]={syscall:"machine"!==n,evaluate:t}}debugBefore(s,i){let r,a,o;if(wt){let n=s[xt].fetchRegister(ye)-i.size;[a,r]=e(s[Bt],i,i.isMachine),K.log(`${n}. ${t(a,r)}`);let o=[];for(let e in r)o.push(e,"=",r[e]);K.log(...o)}return kt&&(o=s.fetchValue(ke)),n(s.fetchValue(ke)),{sp:o,pc:s.fetchValue(ye),name:a,params:r,type:i.type,isMachine:i.isMachine,size:i.size,state:void 0}}debugAfter(e,n){let{sp:i,type:r,isMachine:a,pc:o}=n;if(kt){let l=s(r,a),c=e.fetchValue(ke)-i;if(l&&l.check&&"number"==typeof l.stackChange&&l.stackChange!==c)throw new Error(`Error in ${n.name}:\n\n${o}. ${t(n.name,n.params)}\n\nStack changed by ${c}, expected ${l.stackChange}`);wt&&(K.log("%c -> pc: %d, ra: %d, fp: %d, sp: %d, s0: %O, s1: %O, t0: %O, t1: %O, v0: %O","color: orange",e[xt].registers[ye],e[xt].registers[we],e[xt].registers[Se],e[xt].registers[ke],e.s0,e.s1,e.t0,e.t1,e.v0),K.log("%c -> eval stack","color: red",e.stack.toArray()),K.log("%c -> block stack","color: magenta",e.elements().debugBlocks()),K.log("%c -> destructor stack","color: violet",e[Ct].toArray()),null===e[Nt].scope.current?K.log("%c -> scope","color: green","null"):K.log("%c -> scope","color: green",e.scope().slots.map((e=>function(e){return null!==e&&!Array.isArray(e)}(e)?T(e):e))),K.log("%c -> elements","color: blue",e.elements()[mn].current.element),K.log("%c -> constructing","color: aqua",e.elements().constructing))}}evaluate(e,t,n){let s=j(this.evaluateOpcode[n]);s.syscall?(J(!t.isMachine,`BUG: Mismatch between operation.syscall (${s.syscall}) and opcode.isMachine (${t.isMachine}) for ${t.type}`),s.evaluate(e,t)):(J(t.isMachine,`BUG: Mismatch between operation.syscall (${s.syscall}) and opcode.isMachine (${t.isMachine}) for ${t.type}`),s.evaluate(e[xt],t))}},Sn=Symbol("TYPE"),En=Symbol("INNER"),xn=Symbol("OWNER"),Cn=Symbol("ARGS"),Nn=Symbol("RESOLVED"),Tn=new WeakSet;function _n(e){return Tn.has(e)}function Bn(e,t){return _n(e)&&e[Sn]===t}class An{[Sn];[En];[xn];[Cn];[Nn];constructor(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Tn.add(this),this[Sn]=e,this[En]=t,this[xn]=n,this[Cn]=s,this[Nn]=i}}function Mn(e){let t,n,s,i,r,a=e;for(;;){let{[Cn]:e,[En]:o}=a;if(null!==e){let{named:s,positional:i}=e;i.length>0&&(t=void 0===t?i:i.concat(t)),void 0===n&&(n=[]),n.unshift(s)}if(!_n(o)){s=o,i=a[xn],r=a[Nn];break}a=o}return{definition:s,owner:i,resolved:r,positional:t,named:n}}function Rn(e,t,n,s){return new An(e,t,n,s,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}function On(e){return"getDebugCustomRenderTree"in e}wn.add(ve.ChildScope,(e=>e.pushChildScope())),wn.add(ve.PopScope,(e=>e.popScope())),wn.add(ve.PushDynamicScope,(e=>e.pushDynamicScope())),wn.add(ve.PopDynamicScope,(e=>e.popDynamicScope())),wn.add(ve.Constant,((e,t)=>{let{op1:n}=t;e.stack.push(e[Bt].getValue(Q(n)))})),wn.add(ve.ConstantReference,((e,t)=>{let{op1:n}=t;e.stack.push(B(e[Bt].getValue(Q(n)),!1))})),wn.add(ve.Primitive,((e,t)=>{let{op1:n}=t,s=e.stack;if(Z(n)){let t=e[Bt].getValue(Q(n));s.push(t)}else s.push(ee(n))})),wn.add(ve.PrimitiveReference,(e=>{let t,n=e.stack,s=i(n.pop(),r);t=void 0===s?N:null===s?R:!0===s?O:!1===s?L:A(s),n.push(t)})),wn.add(ve.Dup,((e,t)=>{let{op1:n,op2:s}=t,r=i(e.fetchValue(n),a)-s;e.stack.dup(r)})),wn.add(ve.Pop,((e,t)=>{let{op1:n}=t;e.stack.pop(n)})),wn.add(ve.Load,((e,t)=>{let{op1:n}=t;e.load(n)})),wn.add(ve.Fetch,((e,t)=>{let{op1:n}=t;e.fetch(n)})),wn.add(ve.BindDynamicScope,((e,t)=>{let{op1:n}=t,s=e[Bt].getArray(n);e.bindDynamicScope(s)})),wn.add(ve.Enter,((e,t)=>{let{op1:n}=t;e.enter(n)})),wn.add(ve.Exit,(e=>{e.exit()})),wn.add(ve.PushSymbolTable,((e,t)=>{let{op1:n}=t;e.stack.push(e[Bt].getValue(n))})),wn.add(ve.PushBlockScope,(e=>{e.stack.push(e.scope())})),wn.add(ve.CompileBlock,(e=>{let t=e.stack,n=t.pop();n?t.push(e.compile(n)):t.push(null)})),wn.add(ve.InvokeYield,(e=>{let{stack:t}=e,n=i(t.pop(),o(l)),s=i(t.pop(),o(ss)),r=i(t.pop(),o(c));J(null===r||r&&"object"==typeof r&&Array.isArray(r.parameters),`Expected top of stack to be ${"Option<BlockSymbolTable>"}, was ${String(r)}`);let a=i(t.pop(),u(ms));if(null===r)return e.pushFrame(),void e.pushScope(s??e.scope());let d=F(s,"BUG: expected scope");{let e=r.parameters,t=e.length;if(t>0){d=d.child();for(let n=0;n<t;n++)d.bindSymbol(j(e[n]),a.at(n))}}e.pushFrame(),e.pushScope(d),e.call(n)})),wn.add(ve.JumpIf,((e,t)=>{let{op1:n}=t,s=i(e.stack.pop(),Xn),r=Boolean(T(s));M(s)?!0===r&&e.goto(n):(!0===r&&e.goto(n),e.updateWith(new Ln(s)))})),wn.add(ve.JumpUnless,((e,t)=>{let{op1:n}=t,s=i(e.stack.pop(),Xn),r=Boolean(T(s));M(s)?!1===r&&e.goto(n):(!1===r&&e.goto(n),e.updateWith(new Ln(s)))})),wn.add(ve.JumpEq,((e,t)=>{let{op1:n,op2:s}=t;i(e.stack.peek(),a)===s&&e.goto(n)})),wn.add(ve.AssertSame,(e=>{let t=i(e.stack.peek(),Xn);!1===M(t)&&e.updateWith(new Ln(t))})),wn.add(ve.ToBoolean,(e=>{let{stack:t}=e,n=i(t.pop(),Xn);t.push(_((()=>Ge(T(n)))))}));class Ln{last;constructor(e){this.ref=e,this.last=T(e)}evaluate(e){let{last:t,ref:n}=this;t!==T(n)&&e.throw()}}class Dn{last;constructor(e,t){this.ref=e,this.filter=t,this.last=t(T(e))}evaluate(e){let{last:t,ref:n,filter:s}=this;t!==s(T(n))&&e.throw()}}class Vn{tag=qe;lastRevision=Ke;target;finalize(e,t){this.target=t,this.didModify(e)}evaluate(e){let{tag:t,target:n,lastRevision:s}=this;!e.alwaysRevalidate&&Xe(t,s)&&(Qe(t),e.goto(F(n,"VM BUG: Target must be set before attempting to jump")))}didModify(e){this.tag=e,this.lastRevision=Ze(this.tag),Qe(e)}}class Un{constructor(e){this.debugLabel=e}evaluate(){Ye(this.debugLabel)}}class In{constructor(e){this.target=e}evaluate(){let e=Je();this.target.didModify(e)}}wn.add(ve.Text,((e,t)=>{let{op1:n}=t;e.elements().appendText(e[Bt].getValue(n))})),wn.add(ve.Comment,((e,t)=>{let{op1:n}=t;e.elements().appendComment(e[Bt].getValue(n))})),wn.add(ve.OpenElement,((e,t)=>{let{op1:n}=t;e.elements().openElement(e[Bt].getValue(n))})),wn.add(ve.OpenDynamicElement,(e=>{let t=i(T(i(e.stack.pop(),Xn)),d);e.elements().openElement(t)})),wn.add(ve.PushRemoteElement,(e=>{let t=i(e.stack.pop(),Xn),n=i(e.stack.pop(),Xn),s=i(e.stack.pop(),Xn),r=i(T(t),h),a=i(T(n),p(o(m))),l=T(s);M(t)||e.updateWith(new Ln(t)),void 0===a||M(n)||e.updateWith(new Ln(n));let c=e.elements().pushRemoteElement(r,l,a);c&&e.associateDestroyable(c)})),wn.add(ve.PopRemoteElement,(e=>{e.elements().popRemoteElement()})),wn.add(ve.FlushElement,(e=>{let t=i(e.fetchValue(xe),Kn),n=null;t&&(n=t.flush(e),e.loadValue(xe,null)),e.elements().flushElement(n)})),wn.add(ve.CloseElement,(e=>{let t=e.elements().closeElement();t&&t.forEach((t=>{e.env.scheduleInstallModifier(t);let{manager:n,state:s}=t,i=n.getDestroyable(s);i&&e.associateDestroyable(i)}))})),wn.add(ve.Modifier,((e,t)=>{let{op1:n}=t;if(!1===e.env.isInteractive)return;let s=e.getOwner(),r=i(e.stack.pop(),Zn),a=e[Bt].getValue(n),{manager:o}=a,{constructing:l}=e.elements(),c=o.create(s,F(l,"BUG: ElementModifier could not find the element it applies to"),a.state,r.capture()),u={manager:o,state:c,definition:a};F(i(e.fetchValue(xe),Kn),"BUG: ElementModifier could not find operations to append to").addModifier(u);let d=o.getTag(c);return null!==d?(Qe(d),e.updateWith(new $n(d,u))):void 0})),wn.add(ve.DynamicModifier,(e=>{if(!1===e.env.isInteractive)return;let{stack:t,[Bt]:n}=e,s=i(t.pop(),Xn),r=i(t.pop(),Zn).capture(),{constructing:a}=e.elements(),o=e.getOwner(),l=_((()=>{let e,t,i=T(s);if(!X(i))return;if(Bn(i,Ee.Modifier)){let{definition:n,owner:s,positional:a,named:o}=Mn(i);t=n,e=s,void 0!==a&&(r.positional=a.concat(r.positional)),void 0!==o&&(r.named=G({},...o,r.named))}else t=i,e=o;let l=n.modifier(t,null,!0);if(null===l)throw new Error(`Expected a dynamic modifier definition, but received an object or function that did not have a modifier manager associated with it. The dynamic invocation was \`{{${s.debugLabel}}}\`, and the incorrect definition is the value at the path \`${s.debugLabel}\`, which was: ${te(t)}`);let c=n.getValue(F(l,"BUG: modifier handle expected")),{manager:u}=c,d=u.create(e,F(a,"BUG: ElementModifier could not find the element it applies to"),c.state,r);return{manager:u,state:d,definition:c}})),c=T(l),u=null;if(void 0!==c){F(i(e.fetchValue(xe),Kn),"BUG: ElementModifier could not find operations to append to").addModifier(c),u=c.manager.getTag(c.state),null!==u&&Qe(u)}return!M(s)||u?e.updateWith(new Hn(u,c,l)):void 0}));class $n{lastUpdated;constructor(e,t){this.tag=e,this.modifier=t,this.lastUpdated=Ze(e)}evaluate(e){let{modifier:t,tag:n,lastUpdated:s}=this;Qe(n),Xe(n,s)||(e.env.scheduleUpdateModifier(t),this.lastUpdated=Ze(n))}}class Hn{lastUpdated;constructor(e,t,n){this.tag=e,this.instance=t,this.instanceRef=n,this.lastUpdated=Ze(e??et)}evaluate(e){let{tag:t,lastUpdated:n,instance:s,instanceRef:i}=this,r=T(i);if(r!==s){if(void 0!==s){let e=s.manager.getDestroyable(s.state);null!==e&&De(e)}if(void 0!==r){let{manager:n,state:s}=r,i=n.getDestroyable(s);null!==i&&Ve(this,i),t=n.getTag(s),null!==t&&(this.lastUpdated=Ze(t)),this.tag=t,e.env.scheduleInstallModifier(r)}this.instance=r}else null===t||Xe(t,n)||(e.env.scheduleUpdateModifier(s),this.lastUpdated=Ze(t));null!==t&&Qe(t)}}wn.add(ve.StaticAttr,((e,t)=>{let{op1:n,op2:s,op3:i}=t,r=e[Bt].getValue(n),a=e[Bt].getValue(s),o=i?e[Bt].getValue(i):null;e.elements().setStaticAttribute(r,a,o)})),wn.add(ve.DynamicAttr,((e,t)=>{let{op1:n,op2:s,op3:r}=t,a=e[Bt].getValue(n),o=e[Bt].getValue(s),l=i(e.stack.pop(),Xn),c=T(l),u=r?e[Bt].getValue(r):null,d=e.elements().setDynamicAttribute(a,c,o,u);M(l)||e.updateWith(new Pn(l,d,e.env))}));class Pn{updateRef;constructor(e,t,n){let s=!1;this.updateRef=_((()=>{let i=T(e);!0===s?t.update(i,n):s=!0})),T(this.updateRef)}evaluate(){T(this.updateRef)}}wn.add(ve.PushComponentDefinition,((e,t)=>{let{op1:n}=t,s=e[Bt].getValue(n);J(!!s,`Missing component for ${n}`);let{manager:i,capabilities:r}=s,a={definition:s,manager:i,capabilities:r,state:null,handle:null,table:null,lookup:null};e.stack.push(a)})),wn.add(ve.ResolveDynamicComponent,((e,t)=>{let n,{op1:s}=t,r=e.stack,a=i(T(i(r.pop(),Xn)),f(d,os)),o=e[Bt],l=e.getOwner(),c=o.getValue(s);if(e.loadValue(Ce,null),"string"==typeof a){if(c)throw new Error(`Attempted to resolve a dynamic component with a string definition, \`${a}\` in a strict mode template. In strict mode, using strings to resolve component definitions is prohibited. You can instead import the component definition and use it directly.`);let t=function(e,t,n,s){let i=e.lookupComponent(n,F(s,"BUG: expected owner when looking up component"));if(!i)throw new Error(`Attempted to resolve \`${n}\`, which was expected to be a component, but nothing was found.`);return t.resolvedComponent(i,n)}(e.runtime.resolver,o,a,l);n=F(t,`Could not find a component named "${a}"`)}else n=_n(a)?a:o.component(a,l);r.push(n)})),wn.add(ve.ResolveCurriedComponent,(e=>{let t,n=e.stack,s=i(n.pop(),Xn),r=T(s),a=e[Bt];if("function"!=typeof r&&("object"!=typeof r||null===r))throw new Error(`Expected a component definition, but received ${r}. You may have accidentally done <${s.debugLabel}>, where "${s.debugLabel}" was a string instead of a curried component definition. You must either use the component definition directly, or use the {{component}} helper to create a curried component definition when invoking dynamically.`);if(_n(r))t=r;else if(t=a.component(r,e.getOwner(),!0),null===t)throw new Error(`Expected a dynamic component definition, but received an object or function that did not have a component manager associated with it. The dynamic invocation was \`<${s.debugLabel}>\` or \`{{${s.debugLabel}}}\`, and the incorrect definition is the value at the path \`${s.debugLabel}\`, which was: ${te(r)}`);n.push(t)})),wn.add(ve.PushDynamicComponentInstance,(e=>{let t,n,{stack:s}=e,i=s.pop();_n(i)?n=t=null:(n=i.manager,t=i.capabilities),s.push({definition:i,capabilities:t,manager:n,state:null,handle:null,table:null})})),wn.add(ve.PushArgs,((e,t)=>{let{op1:n,op2:s,op3:i}=t,r=e.stack,a=e[Bt].getArray(n),o=i>>4,l=8&i,c=7&i?e[Bt].getArray(s):ne;e[At].setup(r,a,c,o,!!l),r.push(e[At])})),wn.add(ve.PushEmptyArgs,(e=>{let{stack:t}=e;t.push(e[At].empty(t))})),wn.add(ve.CaptureArgs,(e=>{let t=e.stack,n=i(t.pop(),u(ms)).capture();t.push(n)})),wn.add(ve.PrepareArgs,((e,t)=>{let{op1:n}=t,s=e.stack,r=e.fetchValue(n),a=i(s.pop(),u(ms)),{definition:o}=r;if(Bn(o,Ee.Component)){J(!o.manager,"If the component definition was curried, we don't yet have a manager");let t=e[Bt],{definition:n,owner:s,resolved:i,positional:l,named:c}=Mn(o);if(!0===i)o=n;else if("string"==typeof n){let i=e.runtime.resolver.lookupComponent(n,s);o=t.resolvedComponent(F(i,"BUG: expected resolved component"),n)}else o=t.component(n,s);void 0!==c&&a.named.merge(G({},...c)),void 0!==l&&(a.realloc(l.length),a.positional.prepend(l));let{manager:u}=o;J(null===r.manager,"component instance manager should not be populated yet"),J(null===r.capabilities,"component instance manager should not be populated yet"),r.definition=o,r.manager=u,r.capabilities=o.capabilities,e.loadValue(Ce,s)}let{manager:l,state:c}=o,d=r.capabilities;if(!ct(l,d,Ne.prepareArgs))return void s.push(a);let h=a.blocks.values,p=a.blocks.names,m=l.prepareArgs(c,a);if(m){a.clear();for(let e=0;e<h.length;e++)s.push(h[e]);let{positional:e,named:t}=m,n=e.length;for(let t=0;t<n;t++)s.push(e[t]);let i=Object.keys(t);for(let e=0;e<i.length;e++)s.push(t[j(i[e])]);a.setup(s,i,p,n,!1)}s.push(a)})),wn.add(ve.CreateComponent,((e,t)=>{let{op1:n,op2:s}=t,r=i(e.fetchValue(s),as),{definition:a,manager:o,capabilities:l}=r;if(!ct(o,l,Ne.createInstance))return;let c=null;ct(o,l,Ne.dynamicScope)&&(c=e.dynamicScope());let u=1&n,d=null;ct(o,l,Ne.createArgs)&&(d=i(e.stack.peek(),Zn));let h=null;ct(o,l,Ne.createCaller)&&(h=e.getSelf());let p=o.create(e.getOwner(),a.state,d,e.env,c,h,!!u);r.state=p,ct(o,l,Ne.updateHook)&&e.updateWith(new Wn(p,o,c))})),wn.add(ve.RegisterComponentDestructor,((e,t)=>{let{op1:n}=t,{manager:s,state:r,capabilities:a}=i(e.fetchValue(n),as),o=s.getDestroyable(r);if(!ct(s,a,Ne.willDestroy)&&null!==o&&"string"in o)throw new Error("BUG: Destructor has willDestroy, but the willDestroy capability was not enabled for this component. Pre-destruction hooks must be explicitly opted into");o&&e.associateDestroyable(o)})),wn.add(ve.BeginComponentTransaction,((e,t)=>{let n,{op1:s}=t;{let{definition:t,manager:r}=i(e.fetchValue(s),as);n=t.resolvedName??r.getDebugName(t.state)}e.beginCacheGroup(n),e.elements().pushSimpleBlock()})),wn.add(ve.PutComponentOperations,(e=>{e.loadValue(xe,new Gn)})),wn.add(ve.ComponentAttr,((e,t)=>{let{op1:n,op2:s,op3:r}=t,a=e[Bt].getValue(n),o=e[Bt].getValue(s),l=i(e.stack.pop(),Xn),c=r?e[Bt].getValue(r):null;i(e.fetchValue(xe),u(Gn)).setAttribute(a,l,o,c)})),wn.add(ve.StaticComponentAttr,((e,t)=>{let{op1:n,op2:s,op3:r}=t,a=e[Bt].getValue(n),o=e[Bt].getValue(s),l=r?e[Bt].getValue(r):null;i(e.fetchValue(xe),u(Gn)).setStaticAttribute(a,o,l)}));class Gn{attributes=se();classes=[];modifiers=[];setAttribute(e,t,n,s){let i={value:t,namespace:s,trusting:n};"class"===e&&this.classes.push(t),this.attributes[e]=i}setStaticAttribute(e,t,n){let s={value:t,namespace:n};"class"===e&&this.classes.push(t),this.attributes[e]=s}addModifier(e){this.modifiers.push(e)}flush(e){let t,n=this.attributes;for(let s in this.attributes){if("type"===s){t=n[s];continue}let i=j(this.attributes[s]);"class"===s?Fn(e,"class",jn(this.classes),i.namespace,i.trusting):Fn(e,s,i.value,i.namespace,i.trusting)}return void 0!==t&&Fn(e,"type",t.value,t.namespace,t.trusting),this.modifiers}}function jn(e){return 0===e.length?"":1===e.length?j(e[0]):function(e){for(let t=0;t<e.length;t++)if("string"!=typeof e[t])return!1;return!0}(e)?e.join(" "):(t=e,_((()=>{let e=[];for(const n of t){let t=Vt("string"==typeof n?n:T(n));t&&e.push(t)}return 0===e.length?null:e.join(" ")})));var t}function Fn(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"==typeof n)e.elements().setStaticAttribute(t,n,s);else{let r=e.elements().setDynamicAttribute(t,T(n),i,s);M(n)||e.updateWith(new Pn(n,r,e.env))}}function zn(e,t,n,s,i){let r=n.table.symbols.indexOf(e),a=s.get(t);-1!==r&&i.scope().bindBlock(r+1,a),n.lookup&&(n.lookup[e]=a)}wn.add(ve.DidCreateElement,((e,t)=>{let{op1:n}=t,{definition:s,state:r}=i(e.fetchValue(n),as),{manager:a}=s,o=i(e.fetchValue(xe),u(Gn));a.didCreateElement(r,F(e.elements().constructing,"Expected a constructing element in DidCreateOpcode"),o)})),wn.add(ve.GetComponentSelf,((e,t)=>{let{op1:n,op2:s}=t,r=i(e.fetchValue(n),as),{definition:a,state:o}=r,{manager:l}=a,c=l.getSelf(o);if(void 0!==e.env.debugRenderTree){let t,r,a=i(e.fetchValue(n),as),{definition:l,manager:u}=a;if(e.stack.peek()===e[At])t=e[At].capture();else{let n=e[Bt].getArray(s);e[At].setup(e.stack,n,[],0,!0),t=e[At].capture()}let d=l.compilable;if(null===d?(J(ct(u,a.capabilities,Ne.dynamicLayout),"BUG: No template was found for this component, and the component did not have the dynamic layout capability"),d=u.getDynamicLayout(o,e.runtime.resolver),r=null!==d?d.moduleName:"__default__.hbs"):r=d.moduleName,e.associateDestroyable(a),On(u)){u.getDebugCustomRenderTree(a.definition.state,a.state,t,r).forEach((t=>{let{bucket:n}=t;e.env.debugRenderTree.create(n,t),Le(a,(()=>{e.env.debugRenderTree?.willDestroy(n)})),e.updateWith(new Jn(n))}))}else{let n=l.resolvedName??u.getDebugName(l.state);e.env.debugRenderTree.create(a,{type:"component",name:n,args:t,template:r,instance:T(c)}),e.associateDestroyable(a),Le(a,(()=>{e.env.debugRenderTree?.willDestroy(a)})),e.updateWith(new Jn(a))}}e.stack.push(c)})),wn.add(ve.GetComponentTagName,((e,t)=>{let{op1:n}=t,{definition:s,state:r}=i(e.fetchValue(n),as),{manager:a}=s,o=a.getTagName(r);e.stack.push(o)})),wn.add(ve.GetComponentLayout,((e,t)=>{let{op1:n}=t,s=i(e.fetchValue(n),as),{manager:r,definition:a}=s,{stack:o}=e,{compilable:l}=a;if(null===l){let{capabilities:t}=s;J(ct(r,t,Ne.dynamicLayout),"BUG: No template was found for this component, and the component did not have the dynamic layout capability"),l=r.getDynamicLayout(s.state,e.runtime.resolver),null===l&&(l=ct(r,t,Ne.wrapped)?ie(e[Bt].defaultTemplate).asWrappedLayout():ie(e[Bt].defaultTemplate).asLayout())}let c=l.compile(e.context);o.push(l.symbolTable),o.push(c)})),wn.add(ve.Main,((e,t)=>{let{op1:n}=t,s=i(e.stack.pop(),ps),r=i(e.stack.pop(),ls),{manager:a,capabilities:o}=s,l={definition:s,manager:a,capabilities:o,state:null,handle:r.handle,table:r.symbolTable,lookup:null};e.loadValue(n,l)})),wn.add(ve.PopulateLayout,((e,t)=>{let{op1:n}=t,{stack:s}=e,r=i(s.pop(),l),a=i(s.pop(),g),o=i(e.fetchValue(n),as);o.handle=r,o.table=a})),wn.add(ve.VirtualRootScope,((e,t)=>{let n,{op1:s}=t,{table:r,manager:a,capabilities:o,state:l}=i(e.fetchValue(s),cs);ct(a,o,Ne.hasSubOwner)?(n=a.getOwner(l),e.loadValue(Ce,null)):(n=e.fetchValue(Ce),null===n?n=e.getOwner():e.loadValue(Ce,null)),e.pushRootScope(r.symbols.length+1,n)})),wn.add(ve.SetupForEval,((e,t)=>{let{op1:n}=t,s=i(e.fetchValue(n),cs);if(s.table.hasEval){let t=s.lookup=se();e.scope().bindEvalScope(t)}})),wn.add(ve.SetNamedVariables,((e,t)=>{let{op1:n}=t,s=i(e.fetchValue(n),cs),r=e.scope(),a=i(e.stack.peek(),Zn),o=a.named.atNames;for(let e=o.length-1;e>=0;e--){let t=j(o[e]),n=s.table.symbols.indexOf(t),i=a.named.get(t,!0);-1!==n&&r.bindSymbol(n+1,i),s.lookup&&(s.lookup[t]=i)}})),wn.add(ve.SetBlocks,((e,t)=>{let{op1:n}=t,s=i(e.fetchValue(n),cs),{blocks:r}=i(e.stack.peek(),Zn);for(const[t]of re(r.names))zn(j(r.symbolNames[t]),j(r.names[t]),s,r,e)})),wn.add(ve.InvokeComponentLayout,((e,t)=>{let{op1:n}=t,s=i(e.fetchValue(n),cs);e.call(s.handle)})),wn.add(ve.DidRenderLayout,((e,t)=>{let{op1:n}=t,s=i(e.fetchValue(n),as),{manager:r,state:a,capabilities:o}=s,l=e.elements().popBlock();if(void 0!==e.env.debugRenderTree)if(On(r)){r.getDebugCustomRenderTree(s.definition.state,a,_s).reverse().forEach((t=>{let{bucket:n}=t;e.env.debugRenderTree.didRender(n,l),e.updateWith(new qn(n,l))}))}else e.env.debugRenderTree.didRender(s,l),e.updateWith(new qn(s,l));if(ct(r,o,Ne.createInstance)){i(r,b({didRenderLayout:v})).didRenderLayout(a,l),e.env.didCreate(s),e.updateWith(new Yn(s,l))}})),wn.add(ve.CommitComponentTransaction,(e=>{e.commitCacheGroup()}));class Wn{constructor(e,t,n){this.component=e,this.manager=t,this.dynamicScope=n}evaluate(e){let{component:t,manager:n,dynamicScope:s}=this;n.update(t,s)}}class Yn{constructor(e,t){this.component=e,this.bounds=t}evaluate(e){let{component:t,bounds:n}=this,{manager:s,state:i}=t;s.didUpdateLayout(i,n),e.env.didUpdate(t)}}class Jn{constructor(e){this.bucket=e}evaluate(e){e.env.debugRenderTree?.update(this.bucket)}}class qn{constructor(e,t){this.bucket=e,this.bounds=t}evaluate(e){e.env.debugRenderTree?.didRender(this.bucket,this.bounds)}}b({[tt]:v});const Kn=y((()=>o(u(Gn))));const Xn=new class{validate(e){return"object"==typeof e&&null!==e&&D in e}expected(){return"Reference"}},Qn=b({next:v,isEmpty:v}),Zn=y((()=>u(ms))),es=v;const ts=new class{validate(e){return e===N}expected(){return"undefined"}},ns=b({positional:y((()=>k(Xn))),named:y((()=>w(Xn)))}),ss=y((()=>u(Et))),is=b({getCapabilities:v}),rs=a,as=b({definition:S,state:S,handle:S,table:S}),os=f(E,v),ls=b({handle:a,symbolTable:g});b({setAttribute:v});const cs=b({definition:S,state:S,handle:l,table:g}),us=b({compile:v,symbolTable:c}),ds=b({compile:v,symbolTable:g}),hs=b({0:us,1:ss,2:c}),ps=b({resolvedName:o(d),handle:a,state:f(E,v),manager:is,capabilities:rs,compilable:ds});class ms{stack=null;positional=new gs;named=new bs;blocks=new ks;empty(e){let t=e[Tt][ke]+1;return this.named.empty(e,t),this.positional.empty(e,t),this.blocks.empty(e,t),this}setup(e,t,n,s,i){this.stack=e;let r=this.named,a=t.length,o=e[Tt][ke]-a+1;r.setup(e,o,a,t,i);let l=o-s;this.positional.setup(e,l,s);let c=this.blocks,u=n.length,d=l-3*u;c.setup(e,d,u,n)}get base(){return this.blocks.base}get length(){return this.positional.length+this.named.length+3*this.blocks.length}at(e){return this.positional.at(e)}realloc(e){let{stack:t}=this;if(e>0&&null!==t){let{positional:n,named:s}=this,i=n.base+e;for(let e=n.length+s.length-1;e>=0;e--)t.copy(e+n.base,e+i);n.base+=e,s.base+=e,t[Tt][ke]+=e}}capture(){let e=0===this.positional.length?Ts:this.positional.capture();return{named:0===this.named.length?Ns:this.named.capture(),positional:e}}clear(){let{stack:e,length:t}=this;t>0&&null!==e&&e.pop(t)}}const fs=ae();class gs{base=0;length=0;stack=null;_references=null;empty(e,t){this.stack=e,this.base=t,this.length=0,this._references=fs}setup(e,t,n){this.stack=e,this.base=t,this.length=n,this._references=0===n?fs:null}at(e){let{base:t,length:n,stack:s}=this;return e<0||e>=n?N:i(s.get(e,t),Xn)}capture(){return this.references}prepend(e){let t=e.length;if(t>0){let{base:n,length:s,stack:i}=this;this.base=n-=t,this.length=s+t;for(let s=0;s<t;s++)i.set(e[s],s,n);this._references=null}}get references(){let e=this._references;if(!e){let{stack:t,base:n,length:s}=this;e=this._references=t.slice(n,n+s)}return e}}class bs{base=0;length=0;_references=null;_names=ne;_atNames=ne;empty(e,t){this.stack=e,this.base=t,this.length=0,this._references=fs,this._names=ne,this._atNames=ne}setup(e,t,n,s,i){this.stack=e,this.base=t,this.length=n,0===n?(this._references=fs,this._names=ne,this._atNames=ne):(this._references=null,i?(this._names=null,this._atNames=s):(this._names=s,this._atNames=null))}get names(){let e=this._names;return e||(e=this._names=this._atNames.map(this.toSyntheticName)),e}get atNames(){let e=this._atNames;return e||(e=this._atNames=this._names.map(this.toAtName)),e}has(e){return-1!==this.names.indexOf(e)}get(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{base:n,stack:s}=this,i=(t?this.atNames:this.names).indexOf(e);if(-1===i)return N;let r=s.get(i,n);return V(t?e:`@${e}`,r)}capture(){let{names:e,references:t}=this,n=se();for(const[s,i]of re(e))n[i]=V(`@${i}`,j(t[s]));return n}merge(e){let t=Object.keys(e);if(t.length>0){let{names:n,length:s,stack:i}=this,r=n.slice();for(const n of t){-1===r.indexOf(n)&&(s=r.push(n),i.push(e[n]))}this.length=s,this._references=null,this._names=r,this._atNames=null}}get references(){let e=this._references;if(!e){let{base:t,length:n,stack:s}=this;e=this._references=s.slice(t,t+n)}return e}toSyntheticName(e){return e.slice(1)}toAtName(e){return`@${e}`}}function vs(e){return`&${e}`}const ys=ae();class ks{internalValues=null;_symbolNames=null;internalTag=null;names=ne;length=0;base=0;empty(e,t){this.stack=e,this.names=ne,this.base=t,this.length=0,this._symbolNames=null,this.internalTag=qe,this.internalValues=ys}setup(e,t,n,s){this.stack=e,this.names=s,this.base=t,this.length=n,this._symbolNames=null,0===n?(this.internalTag=qe,this.internalValues=ys):(this.internalTag=null,this.internalValues=null)}get values(){let e=this.internalValues;if(!e){let{base:t,length:n,stack:s}=this;e=this.internalValues=s.slice(t,t+3*n)}return e}has(e){return-1!==this.names.indexOf(e)}get(e){let t=this.names.indexOf(e);if(-1===t)return null;let{base:n,stack:s}=this,r=i(s.get(3*t,n),o(c)),a=i(s.get(3*t+1,n),o(ss)),u=i(s.get(3*t+2,n),o(f(l,us)));return null===u?null:[u,a,r]}capture(){return new ws(this.names,this.values)}get symbolNames(){let e=this._symbolNames;return null===e&&(e=this._symbolNames=this.names.map(vs)),e}}class ws{length;constructor(e,t){this.names=e,this.values=t,this.length=e.length}has(e){return-1!==this.names.indexOf(e)}get(e){let t=this.names.indexOf(e);return-1===t?null:[this.values[3*t+2],this.values[3*t+1],this.values[3*t]]}}function Ss(e,t){return{named:e,positional:t}}function Es(e){let t=se();for(const[n,s]of Object.entries(e))t[n]=T(s);return t}function xs(e){return e.map(T)}function Cs(e){return{named:Es(e.named),positional:xs(e.positional)}}const Ns=Object.freeze(Object.create(null)),Ts=fs,_s=Ss(Ns,Ts);function Bs(e){return"function"!=typeof e.toString?"":String(e)}function As(e,t,n){let s=e.helper(t,null,!0);if(null===s)throw new Error(`Expected a dynamic helper definition, but received an object or function that did not have a helper manager associated with it. The dynamic invocation was \`{{${n.debugLabel}}}\` or \`(${n.debugLabel})\`, and the incorrect definition is the value at the path \`${n.debugLabel}\`, which was: ${te(t)}`);return e.getValue(s)}function Ms(e){return J(Array.isArray(e)||e===N,"a reference other than UNDEFINED_REFERENCE is illegal here"),e===N}wn.add(ve.Curry,((e,t)=>{let{op1:n,op2:s}=t,r=e.stack,a=i(r.pop(),Xn),o=i(r.pop(),ns),l=e.getOwner(),c=e.runtime.resolver,u=!1;u=e[Bt].getValue(Q(s)),e.loadValue(Te,function(e,t,n,s,i,r){let a,o;return _((()=>{let l=T(t);if(l===a)return o;if(Bn(l,e))o=s?Rn(e,l,n,s):s;else if(e===Ee.Component&&"string"==typeof l&&l){if(r)throw new Error(`Attempted to resolve a dynamic component with a string definition, \`${l}\` in a strict mode template. In strict mode, using strings to resolve component definitions is prohibited. You can instead import the component definition and use it directly.`);if(!F(i,"BUG: expected resolver for curried component definitions").lookupComponent(l,n))throw new Error(`Attempted to resolve \`${l}\`, which was expected to be a component, but nothing was found.`);o=Rn(e,l,n,s)}else o=X(l)?Rn(e,l,n,s):null;return a=l,o}))}(n,a,l,o,c,u))})),wn.add(ve.DynamicHelper,(e=>{let t,n=e.stack,s=i(n.pop(),Xn),r=i(n.pop(),Zn).capture(),a=e.getOwner(),o=_((()=>{void 0!==t&&De(t);let n=T(s);if(Bn(n,Ee.Helper)){let{definition:i,owner:a,positional:l,named:c}=Mn(n),u=As(e[Bt],i,s);void 0!==c&&(r.named=G({},...c,r.named)),void 0!==l&&(r.positional=l.concat(r.positional)),t=u(r,a),Ve(o,t)}else if(X(n)){let i=As(e[Bt],n,s);t=i(r,a),Ue(t)&&Ve(o,t)}else t=N})),l=_((()=>(T(o),T(t))));e.associateDestroyable(o),e.loadValue(Te,l)})),wn.add(ve.Helper,((e,t)=>{let{op1:n}=t,s=e.stack,r=i(e[Bt].getValue(n),es)(i(s.pop(),Zn).capture(),e.getOwner(),e.dynamicScope());Ue(r)&&e.associateDestroyable(r),e.loadValue(Te,r)})),wn.add(ve.GetVariable,((e,t)=>{let{op1:n}=t,s=e.referenceForSymbol(n);e.stack.push(s)})),wn.add(ve.SetVariable,((e,t)=>{let{op1:n}=t,s=i(e.stack.pop(),Xn);e.scope().bindSymbol(n,s)})),wn.add(ve.SetBlock,((e,t)=>{let{op1:n}=t,s=i(e.stack.pop(),us),r=i(e.stack.pop(),ss),a=i(e.stack.pop(),c);e.scope().bindBlock(n,[s,r,a])})),wn.add(ve.ResolveMaybeLocal,((e,t)=>{let{op1:n}=t,s=e[Bt].getValue(n),i=e.scope().getPartialMap()[s];void 0===i&&(i=U(e.getSelf(),s)),e.stack.push(i)})),wn.add(ve.RootScope,((e,t)=>{let{op1:n}=t;e.pushRootScope(n,e.getOwner())})),wn.add(ve.GetProperty,((e,t)=>{let{op1:n}=t,s=e[Bt].getValue(n),r=i(e.stack.pop(),Xn);e.stack.push(U(r,s))})),wn.add(ve.GetBlock,((e,t)=>{let{op1:n}=t,{stack:s}=e,i=e.scope().getBlock(n);s.push(i)})),wn.add(ve.SpreadBlock,(e=>{let{stack:t}=e,n=i(t.pop(),o(f(hs,ts)));if(n&&!Ms(n)){let[e,s,i]=n;t.push(i),t.push(s),t.push(e)}else t.push(null),t.push(null),t.push(null)})),wn.add(ve.HasBlock,(e=>{let{stack:t}=e,n=i(t.pop(),o(f(hs,ts)));n&&!Ms(n)?t.push(O):t.push(L)})),wn.add(ve.HasBlockParams,(e=>{let t=e.stack.pop(),n=e.stack.pop();i(t,p(f(l,us))),i(n,p(ss));let s=i(e.stack.pop(),p(c)),r=s&&s.parameters.length;e.stack.push(r?O:L)})),wn.add(ve.Concat,((e,t)=>{let{op1:n}=t,s=new Array(n);for(let t=n;t>0;t--){s[t-1]=i(e.stack.pop(),Xn)}var r;e.stack.push((r=s,_((()=>{let e=new Array;for(const[t,n]of re(r)){let s=T(n);null!=s&&(e[t]=Bs(s))}return e.length>0?e.join(""):null}))))})),wn.add(ve.IfInline,(e=>{let t=i(e.stack.pop(),Xn),n=i(e.stack.pop(),Xn),s=i(e.stack.pop(),Xn);e.stack.push(_((()=>!0===Ge(T(t))?T(n):T(s))))})),wn.add(ve.Not,(e=>{let t=i(e.stack.pop(),Xn);e.stack.push(_((()=>!Ge(T(t)))))})),wn.add(ve.GetDynamicVar,(e=>{let t=e.dynamicScope(),n=e.stack,s=i(n.pop(),Xn);n.push(_((()=>{let e=String(T(s));return T(t.get(e))})))})),wn.add(ve.Log,(e=>{let{positional:t}=i(e.stack.pop(),Zn).capture();e.loadValue(Te,_((()=>{console.log(...xs(t))})))}));class Rs{constructor(e,t,n){this.node=e,this.reference=t,this.lastValue=n}evaluate(){let e,t=T(this.reference),{lastValue:n}=this;if(t!==n&&(e=Ut(t)?"":Ht(t)?t:String(t),e!==n)){this.node.nodeValue=this.lastValue=e}}}function Os(e){return function(e){return Ht(e)||Ut(e)||"boolean"==typeof e||"number"==typeof e}(e)?_e.String:Bn(e,Be.Component)||ut(e)?_e.Component:Bn(e,Be.Helper)||dt(e)?_e.Helper:It(e)?_e.SafeString:function(e){return $t(e)&&11===e.nodeType}(e)?_e.Fragment:$t(e)?_e.Node:_e.String}function Ls(e){if(!X(e))return _e.String;if(Bn(e,Be.Component)||ut(e))return _e.Component;if(!Bn(e,Be.Helper)&&!dt(e))throw new Error(`Attempted use a dynamic value as a component or helper, but that value did not have an associated component or helper manager. The value was: ${e}`);return _e.Helper}function Ds(e,t){console.info("Use `context`, and `get(<path>)` to debug this template."),t("this")}wn.add(ve.ContentType,(e=>{let t=i(e.stack.peek(),Xn);e.stack.push(Os(T(t))),M(t)||e.updateWith(new Dn(t,Os))})),wn.add(ve.DynamicContentType,(e=>{let t=i(e.stack.peek(),Xn);e.stack.push(Ls(T(t))),M(t)||e.updateWith(new Dn(t,Ls))})),wn.add(ve.AppendHTML,(e=>{let t=i(e.stack.pop(),Xn),n=T(t),s=Ut(n)?"":String(n);e.elements().appendDynamicHTML(s)})),wn.add(ve.AppendSafeHTML,(e=>{let t=i(e.stack.pop(),Xn),n=i(T(t),x).toHTML(),s=Ut(n)?"":i(n,d);e.elements().appendDynamicHTML(s)})),wn.add(ve.AppendText,(e=>{let t=i(e.stack.pop(),Xn),n=T(t),s=Ut(n)?"":String(n),r=e.elements().appendDynamicText(s);M(t)||e.updateWith(new Rs(r,t,s))})),wn.add(ve.AppendDocumentFragment,(e=>{let t=i(e.stack.pop(),Xn),n=i(T(t),C);e.elements().appendDynamicFragment(n)})),wn.add(ve.AppendNode,(e=>{let t=i(e.stack.pop(),Xn),n=i(T(t),m);e.elements().appendDynamicNode(n)}));let Vs=Ds;function Us(e){Vs=e}function Is(){Vs=Ds}class $s{locals=se();constructor(e,t,n){this.scope=e;for(const s of n){let n=j(t[s-1]),i=e.getSymbol(s);this.locals[n]=i}}get(e){let t,{scope:n,locals:s}=this,i=e.split("."),[r,...a]=e.split("."),o=n.getEvalScope();return"this"===r?t=n.getSelf():s[r]?t=j(s[r]):0===r.indexOf("@")&&o[r]?t=o[r]:(t=this.scope.getSelf(),a=i),a.reduce(((e,t)=>U(e,t)),t)}}wn.add(ve.Debugger,((e,t)=>{let{op1:n,op2:s}=t,i=e[Bt].getArray(n),r=e[Bt].getArray(Q(s)),a=new $s(e.scope(),i,r);Vs(T(e.getSelf()),(e=>T(a.get(e))))})),wn.add(ve.EnterList,((e,t)=>{let{op1:n,op2:s}=t,r=e.stack,a=i(r.pop(),Xn),o=i(r.pop(),Xn),l=T(o),c=null===l?"@identity":String(l),u=I(a,c),d=T(u);e.updateWith(new Dn(u,(e=>e.isEmpty()))),!0===d.isEmpty()?e.goto(s+1):(e.enterList(u,n),e.stack.push(d))})),wn.add(ve.ExitList,(e=>{e.exitList()})),wn.add(ve.Iterate,((e,t)=>{let{op1:n}=t,s=e.stack,r=i(s.peek(),Qn).next();null!==r?e.registerItem(e.enterItem(r)):e.goto(n)}));const Hs={dynamicLayout:!1,dynamicTag:!1,prepareArgs:!1,createArgs:!1,attributeHook:!1,elementHook:!1,createCaller:!1,dynamicScope:!1,updateHook:!1,createInstance:!1,wrapped:!1,willDestroy:!1,hasSubOwner:!1};class Ps{getCapabilities(){return Hs}getDebugName(e){let{name:t}=e;return t}getSelf(){return R}getDestroyable(){return null}}const Gs=new Ps;class js{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@glimmer/component/template-only",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"(unknown template-only component)";this.moduleName=e,this.name=t}toString(){return this.moduleName}}function Fs(e,t){return new js(e,t)}ht(Gs,js.prototype);const zs={foreignObject:1,desc:1,title:1},Ws=Object.create(null);class Ys{constructor(e){this.document=e,this.setupUselessElement()}setupUselessElement(){this.uselessElement=this.document.createElement("div")}createElement(e,t){let n,s;if(t?(n=t.namespaceURI===z||"svg"===e,s=!!zs[t.tagName]):(n="svg"===e,s=!1),n&&!s){if(Ws[e])throw new Error(`Cannot create a ${e} inside an SVG context`);return this.document.createElementNS(z,e)}return this.document.createElement(e)}insertBefore(e,t,n){e.insertBefore(t,n)}insertHTMLBefore(e,t,n){if(""===n){const n=this.createComment("");return e.insertBefore(n,t),new Rt(e,n,n)}const s=t?t.previousSibling:e.lastChild;let i;if(null===t)e.insertAdjacentHTML(oe,n),i=F(e.lastChild,"bug in insertAdjacentHTML?");else if(t instanceof HTMLElement)t.insertAdjacentHTML("beforebegin",n),i=F(t.previousSibling,"bug in insertAdjacentHTML?");else{const{uselessElement:s}=this;e.insertBefore(s,t),s.insertAdjacentHTML(le,n),i=F(s.previousSibling,"bug in insertAdjacentHTML?"),e.removeChild(s)}const r=F(s?s.nextSibling:e.firstChild,"bug in insertAdjacentHTML?");return new Rt(e,r,i)}createTextNode(e){return this.document.createTextNode(e)}createComment(e){return this.document.createComment(e)}}function Js(e,t,n){if(!e)return t;if(!function(e,t){const n=e.createElementNS(t,"svg");try{n.insertAdjacentHTML(oe,"<circle></circle>")}catch(e){}finally{return 1!==n.childNodes.length||W(j(n.firstChild),"SVG").namespaceURI!==z}}(e,n))return t;const s=e.createElement("div");return class extends t{insertHTMLBefore(e,t,i){return""===i||e.namespaceURI!==n?super.insertHTMLBefore(e,t,i):function(e,t,n,s){let i;if(J(""!==n,"html cannot be empty"),"FOREIGNOBJECT"===e.tagName.toUpperCase()){const e="<svg><foreignObject>"+n+"</foreignObject></svg>";ce(t),t.insertAdjacentHTML(ue,e),i=t.firstChild.firstChild}else{const e="<svg>"+n+"</svg>";ce(t),t.insertAdjacentHTML(ue,e),i=t.firstChild}return function(e,t,n){const s=F(e.firstChild,"source is empty");let i=s,r=s;for(;r;){const e=r.nextSibling;t.insertBefore(r,n),i=r,r=e}return new Rt(t,s,i)}(i,e,s)}(e,s,i,t)}}}function qs(e,t){return e&&function(e){const t=e.createElement("div");if(t.appendChild(e.createTextNode("first")),t.insertAdjacentHTML(oe,"second"),2===t.childNodes.length)return!1;return!0}(e)?class extends t{uselessComment;constructor(e){super(e),this.uselessComment=e.createComment("")}insertHTMLBefore(e,t,n){if(""===n)return super.insertHTMLBefore(e,t,n);let s=!1;const i=t?t.previousSibling:e.lastChild;i&&i instanceof Text&&(s=!0,e.insertBefore(this.uselessComment,t));const r=super.insertHTMLBefore(e,t,n);return s&&e.removeChild(this.uselessComment),r}}:t}const Ks="undefined"==typeof document?null:de(document);let Xs=class extends Ys{createElementNS(e,t){return this.document.createElementNS(e,t)}setAttribute(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}};Xs=qs(Ks,Xs),Xs=Js(Ks,Xs,z);const Qs=Xs;["b","big","blockquote","body","br","center","code","dd","div","dl","dt","em","embed","h1","h2","h3","h4","h5","h6","head","hr","i","img","li","listing","main","meta","nobr","ol","p","pre","ruby","s","small","span","strong","strike","sub","sup","table","tt","u","ul","var"].forEach((e=>Ws[e]=1));const Zs=/[\t\n\v\f\r \xA0\u{1680}\u{180e}\u{2000}-\u{200a}\u{2028}\u{2029}\u{202f}\u{205f}\u{3000}\u{feff}]/u,ei="undefined"==typeof document?null:de(document);function ti(e){return Zs.test(e)}class ni extends Ys{namespace;constructor(e){super(e),this.document=e,this.namespace=null}setAttribute(e,t,n){e.setAttribute(t,n)}removeAttribute(e,t){e.removeAttribute(t)}insertAfter(e,t,n){this.insertBefore(e,t,n.nextSibling)}}let si=ni;si=qs(ei,si),si=Js(ei,si,z);const ii=si;let ri=0;class ai{id=ri++;value;constructor(e){this.value=e}get(){return this.value}release(){if(null===this.value)throw new Error("BUG: double release?");this.value=null}toString(){let e=`Ref ${this.id}`;if(null===this.value)return`${e} (released)`;try{return`${e}: ${this.value}`}catch{return e}}}class oi{stack=new Y;refs=new WeakMap;roots=new Set;nodes=new WeakMap;begin(){this.reset()}create(e,t){let n=G({},t,{bounds:null,refs:new Set});this.nodes.set(e,n),this.appendChild(n,e),this.enter(e)}update(e){this.enter(e)}didRender(e,t){if(this.stack.current!==e)throw new Error(`BUG: expecting ${this.stack.current}, got ${e}`);this.nodeFor(e).bounds=t,this.exit()}willDestroy(e){F(this.refs.get(e),"BUG: missing ref").release()}commit(){this.reset()}capture(){return this.captureRefs(this.roots)}reset(){if(0!==this.stack.size){let e=F(this.stack.toArray()[0],"expected root state when resetting render tree"),t=this.refs.get(e);for(void 0!==t&&this.roots.delete(t);!this.stack.isEmpty();)this.stack.pop()}}enter(e){this.stack.push(e)}exit(){if(0===this.stack.size)throw new Error("BUG: unbalanced pop");this.stack.pop()}nodeFor(e){return F(this.nodes.get(e),"BUG: missing node")}appendChild(e,t){if(this.refs.has(t))throw new Error("BUG: child already appended");let n=this.stack.current,s=new ai(t);if(this.refs.set(t,s),n){let t=this.nodeFor(n);t.refs.add(s),e.parent=t}else this.roots.add(s)}captureRefs(e){let t=[];return e.forEach((n=>{let s=n.get();s?t.push(this.captureNode(`render-node:${n.id}`,s)):e.delete(n)})),t}captureNode(e,t){let n=this.nodeFor(t),{type:s,name:i,args:r,instance:a,refs:o}=n,l=this.captureTemplate(n),c=this.captureBounds(n),u=this.captureRefs(o);return{id:e,type:s,name:i,args:Cs(r),instance:a,template:l,bounds:c,children:u}}captureTemplate(e){let{template:t}=e;return t||null}captureBounds(e){let t=F(e.bounds,"BUG: missing bounds");return{parentElement:t.parentElement(),firstNode:t.firstNode(),lastNode:t.lastNode()}}}const li=Symbol("TRANSACTION");class ci{scheduledInstallModifiers=[];scheduledUpdateModifiers=[];createdComponents=[];updatedComponents=[];didCreate(e){this.createdComponents.push(e)}didUpdate(e){this.updatedComponents.push(e)}scheduleInstallModifier(e){this.scheduledInstallModifiers.push(e)}scheduleUpdateModifier(e){this.scheduledUpdateModifiers.push(e)}commit(){let{createdComponents:e,updatedComponents:t}=this;for(const{manager:t,state:n}of e)t.didCreate(n);for(const{manager:e,state:n}of t)e.didUpdate(n);let{scheduledInstallModifiers:n,scheduledUpdateModifiers:s}=this;for(const{manager:e,state:t,definition:s}of n){let n=e.getTag(t);if(null!==n){let i=nt((()=>e.install(t)),`- While rendering:\n  (instance of a \`${s.resolvedName||e.getDebugName(s.state)}\` modifier)`);st(n,i)}else e.install(t)}for(const{manager:e,state:t,definition:n}of s){let s=e.getTag(t);if(null!==s){let i=nt((()=>e.update(t)),`- While rendering:\n  (instance of a \`${n.resolvedName||e.getDebugName(n.state)}\` modifier)`);st(s,i)}else e.update(t)}}}class ui{[li]=null;updateOperations;isInteractive;debugRenderTree;constructor(e,t){if(this.delegate=t,this.isInteractive=t.isInteractive,this.debugRenderTree=this.delegate.enableDebugTooling?new oi:void 0,e.appendOperations)this.appendOperations=e.appendOperations,this.updateOperations=e.updateOperations;else{if(!e.document)throw new Error("you must pass document or appendOperations to a new runtime");this.appendOperations=new Qs(e.document),this.updateOperations=new ni(e.document)}}getAppendOperations(){return this.appendOperations}getDOM(){return F(this.updateOperations,"Attempted to get DOM updateOperations, but they were not provided by the environment. You may be attempting to rerender in an environment which does not support rerendering, such as SSR.")}begin(){J(!this[li],"A glimmer transaction was begun, but one already exists. You may have a nested transaction, possibly caused by an earlier runtime exception while rendering. Please check your console for the stack trace of any prior exceptions."),this.debugRenderTree?.begin(),this[li]=new ci}get transaction(){return F(this[li],"must be in a transaction")}didCreate(e){this.transaction.didCreate(e)}didUpdate(e){this.transaction.didUpdate(e)}scheduleInstallModifier(e){this.isInteractive&&this.transaction.scheduleInstallModifier(e)}scheduleUpdateModifier(e){this.isInteractive&&this.transaction.scheduleUpdateModifier(e)}commit(){let e=this.transaction;this[li]=null,e.commit(),this.debugRenderTree?.commit(),this.delegate.onTransactionCommit()}}function di(e,t,n,s){return{env:new ui(e,t),program:new vt(n.constants,n.heap),resolver:s}}function hi(e,t){if(e[li])t();else{e.begin();try{t()}finally{e.commit()}}}function pi(e){return pt(e,{})}const mi=pi((e=>{let{positional:t}=e;return _((()=>xs(t)),null,"array")})),fi=e=>(e=>null==e||"function"!=typeof e.toString)(e)?"":String(e),gi=pi((e=>{let{positional:t}=e;return _((()=>xs(t).map(fi).join("")),null,"concat")})),bi=he("`fn` helper"),vi=pi((e=>{let{positional:t}=e,n=i(t[0],yi);return _((()=>function(){let[e,...s]=xs(t);yi(n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];if($(n)){let e=s.length>0?s[0]:r[0];return H(n,e)}return e.call(bi,...s,...r)}),null,"fn")}));function yi(e){if(!e||!$(e)&&"function"!=typeof T(e))throw new Error(`You must pass a function as the \`fn\` helper's first argument, you passed ${e?T(e):e}. While rendering:\n\n${e?.debugLabel}`)}const ki=pi((e=>{let{positional:t}=e,n=t[0]??N,s=t[1]??N;return _((()=>{let e=T(n);if(pe(e))return je(e,String(T(s)))}),(e=>{let t=T(n);if(pe(t))return Fe(t,String(T(s)),e)}),"get")}));let wi;wi=e=>new Proxy(e,{set:(e,t,n)=>(ze(`You set the '${String(t)}' property on a {{hash}} object. Setting properties on objects generated by {{hash}} is deprecated. Please update to use an object created with a tracked property or getter, or with a custom helper.`,!1,{id:"setting-on-hash"}),e[t]=n,!0)});const Si=pi((e=>{let{named:t}=e,n=_((()=>{let e=Es(t);return e=wi(e),e}),null,"hash"),s=new Map;for(let e in t)s.set(e,t[e]);return n.children=s,n}));let Ei=new WeakMap;function xi(e){return rt(Ei.get(e))}class Ci{argsCache;constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>_s,n=it((()=>t(e)));Ei.set(this,n),Object.freeze(this)}get named(){return xi(this).named||Ns}get positional(){return xi(this).positional||Ts}}function Ni(e,t,n){if("object"!=typeof e||null===e)throw new Error(`Expected a context object to be passed as the first parameter to invokeHelper, got ${e}`);const s=yt(e),i=mt(t);if(!i)throw new Error(`Expected a helper definition to be passed as the second parameter to invokeHelper, but no helper manager was found. The definition value that was passed was \`${te(t)}\`. Did you use setHelperManager to associate a helper manager with this value?`);if("function"==typeof i)throw new Error("Found a helper manager, but it was an internal built-in helper manager. `invokeHelper` does not support internal helpers yet.");const r=i.getDelegateFor(s);let a,o=new Ci(e,n),l=r.createHelper(t,o);if(!ft(r))throw new Error("TODO: unreachable, to be implemented with hasScheduledEffect");if(a=it((()=>{if(Ie(a)||$e(a))throw new Error("You attempted to get the value of a helper after the helper was destroyed, which is not allowed");return r.getValue(l)})),Ve(e,a),gt(r)){let e=r.getDestroyable(l);Ve(a,e)}return a}const Ti=he("`on` modifier"),_i=(()=>{try{const e=document.createElement("div");let t,n=0;return e.addEventListener("click",(()=>n++),{once:!0}),"function"==typeof Event?t=new Event("click"):(t=document.createEvent("Event"),t.initEvent("click",!0,!0)),e.dispatchEvent(t),e.dispatchEvent(t),1===n}catch(e){return!1}})();class Bi{tag=at();element;args;once;passive;capture;options;shouldUpdate=!0;constructor(e,t){this.element=e,this.args=t}updateFromArgs(){let e,{args:t}=this,{once:n,passive:s,capture:r}=Es(t.named);n!==this.once&&(this.once=n,this.shouldUpdate=!0),s!==this.passive&&(this.passive=s,this.shouldUpdate=!0),r!==this.capture&&(this.capture=r,this.shouldUpdate=!0),void 0!==n||void 0!==s||void 0!==r?e=this.options={once:n,passive:s,capture:r}:this.options=void 0;let a=F(t.positional[0],"You must pass a valid DOM event name as the first argument to the `on` modifier"),o=i(T(a),d,(()=>"You must pass a valid DOM event name as the first argument to the `on` modifier"));o!==this.eventName&&(this.eventName=o,this.shouldUpdate=!0);const l=F(t.positional[1],"You must pass a function as the second argument to the `on` modifier"),c=i(T(l),v,(e=>`You must pass a function as the second argument to the \`on\` modifier; you passed ${null===e?"null":typeof e}. While rendering:\n\n${l.debugLabel??"{unlabeled value}"}`));if(c!==this.userProvidedCallback&&(this.userProvidedCallback=c,this.shouldUpdate=!0),2!==t.positional.length)throw new Error(`You can only pass two positional arguments (event name and callback) to the \`on\` modifier, but you provided ${t.positional.length}. Consider using the \`fn\` helper to provide additional arguments to the \`on\` callback.`);let u=!1===_i&&n||s;if(this.shouldUpdate)if(u){let t=this.callback=function(i){return s&&(i.preventDefault=()=>{throw new Error(`You marked this listener as 'passive', meaning that you must not call 'event.preventDefault()': \n\n${c.name??"{anonymous function}"}`)}),!_i&&n&&Ri(this,o,t,e),c.call(Ti,i)}}else this.callback=c.bind(Ti)}}let Ai=0,Mi=0;function Ri(e,t,n,s){Mi++,_i?e.removeEventListener(t,n,s):void 0!==s&&s.capture?e.removeEventListener(t,n,!0):e.removeEventListener(t,n)}function Oi(e,t,n,s){Ai++,_i?e.addEventListener(t,n,s):void 0!==s&&s.capture?e.addEventListener(t,n,!0):e.addEventListener(t,n)}const Li=bt(new class{SUPPORTS_EVENT_OPTIONS=_i;getDebugName(){return"on"}get counters(){return{adds:Ai,removes:Mi}}create(e,t,n,s){return new Bi(t,s)}getTag(e){return null===e?null:e.tag}install(e){if(null===e)return;e.updateFromArgs();let{element:t,eventName:n,callback:s,options:i}=e;Oi(t,n,s,i),Le(e,(()=>Ri(t,n,s,i))),e.shouldUpdate=!1}update(e){if(null===e)return;let{element:t,eventName:n,callback:s,options:i}=e;e.updateFromArgs(),e.shouldUpdate&&(Ri(t,n,s,i),Oi(e.element,e.eventName,e.callback,e.options),e.shouldUpdate=!1)}getDestroyable(e){return e}},{});class Di{currentOpSize=0;constructor(e,t,n,s,i){this.stack=e,this.heap=t,this.program=n,this.externs=s,this.registers=i}fetchRegister(e){return this.registers[e]}loadRegister(e,t){this.registers[e]=t}setPc(e){J("number"==typeof e&&!isNaN(e),"pc is set to a number"),this.registers[ye]=e}pushFrame(){this.stack.push(this.registers[we]),this.stack.push(this.registers[Se]),this.registers[Se]=this.registers[ke]-1}popFrame(){this.registers[ke]=this.registers[Se]-1,this.registers[we]=this.stack.get(0),this.registers[Se]=this.stack.get(1)}pushSmallFrame(){this.stack.push(this.registers[we])}popSmallFrame(){this.registers[we]=this.stack.pop()}goto(e){this.setPc(this.target(e))}target(e){return this.registers[ye]+e-this.currentOpSize}call(e){J(e<4294967295,"Jumping to placeholder address"),this.registers[we]=this.registers[ye],this.setPc(this.heap.getaddr(e))}returnTo(e){this.registers[we]=this.target(e)}return(){this.setPc(this.registers[we])}nextStatement(){let{registers:e,program:t}=this,n=e[ye];if(J("number"==typeof n,"pc is a number"),-1===n)return null;let s=t.opcode(n),i=this.currentOpSize=s.size;return this.registers[ye]+=i,s}evaluateOuter(e,t){if(kt){let{externs:{debugBefore:n,debugAfter:s}}=this,i=n(e);this.evaluateInner(e,t),s(i)}else this.evaluateInner(e,t)}evaluateInner(e,t){e.isMachine?this.evaluateMachine(e):this.evaluateSyscall(e,t)}evaluateMachine(e){switch(e.type){case Ae.PushFrame:return this.pushFrame();case Ae.PopFrame:return this.popFrame();case Ae.InvokeStatic:return this.call(e.op1);case Ae.InvokeVirtual:return this.call(this.stack.pop());case Ae.Jump:return this.goto(e.op1);case Ae.Return:return this.return();case Ae.ReturnTo:return this.returnTo(e.op1)}}evaluateSyscall(e,t){wn.evaluate(t,e,e.type)}}class Vi{env;dom;alwaysRevalidate;frameStack=new Y;constructor(e,t){let{alwaysRevalidate:n=!1}=t;this.env=e,this.dom=e.getDOM(),this.alwaysRevalidate=n}execute(e,t){{let n=!0;try{ot.runInTrackingTransaction((()=>this._execute(e,t)),"- While rendering:"),n=!1}finally{n&&console.error(`\n\nError occurred:\n\n${lt()}\n\n`)}}}_execute(e,t){let{frameStack:n}=this;for(this.try(e,t);!n.isEmpty();){let e=this.frame.nextStatement();void 0!==e?e.evaluate(this):n.pop()}}get frame(){return F(this.frameStack.current,"bug: expected a frame")}goto(e){this.frame.goto(e)}try(e,t){this.frameStack.push(new Gi(e,t))}throw(){this.frame.handleException(),this.frameStack.pop()}}class Ui{constructor(e,t){this.state=e,this.resumeCallback=t}resume(e,t){return this.resumeCallback(e,this.state,t)}}class Ii{children;bounds;constructor(e,t,n,s){this.state=e,this.runtime=t,this.children=s,this.bounds=n}parentElement(){return this.bounds.parentElement()}firstNode(){return this.bounds.firstNode()}lastNode(){return this.bounds.lastNode()}evaluate(e){e.try(this.children,null)}}class $i extends Ii{type="try";evaluate(e){e.try(this.children,this)}handleException(){let{state:e,bounds:t,runtime:n}=this;He(this);let s=fn.resume(n.env,t),i=e.resume(n,s),r=[],a=this.children=[],o=i.execute((e=>{e.pushUpdating(r),e.updateWith(this),e.pushUpdating(a)}));Ve(this,o.drop)}}class Hi extends $i{retained=!1;index=-1;constructor(e,t,n,s,i,r){super(e,t,n,[]),this.key=s,this.memo=i,this.value=r}updateReferences(e){this.retained=!0,H(this.value,e.value),H(this.memo,e.memo)}shouldRemove(){return!this.retained}reset(){this.retained=!1}}class Pi extends Ii{type="list-block";opcodeMap=new Map;marker=null;lastIterator;constructor(e,t,n,s,i){super(e,t,n,s),this.iterableRef=i,this.lastIterator=T(i)}initializeChild(e){e.index=this.children.length-1,this.opcodeMap.set(e.key,e)}evaluate(e){let t=T(this.iterableRef);if(this.lastIterator!==t){let{bounds:n}=this,{dom:s}=e,i=this.marker=s.createComment("");s.insertAfter(n.parentElement(),i,F(n.lastNode(),"can't insert after an empty bounds")),this.sync(t),this.parentElement().removeChild(i),this.marker=null,this.lastIterator=t}super.evaluate(e)}sync(e){let{opcodeMap:t,children:n}=this,s=0,i=0;for(this.children=this.bounds.boundList=[];;){let r=e.next();if(null===r)break;let a=n[s],{key:o}=r;for(;void 0!==a&&!0===a.retained;)a=n[++s];if(void 0!==a&&a.key===o)this.retainItem(a,r),s++;else if(t.has(o)){let e=t.get(o);if(e.index<i)this.moveItem(e,r,a);else{i=e.index;let t=!1;for(let e=s+1;e<i;e++)if(!1===j(n[e]).retained){t=!0;break}!1===t?(this.retainItem(e,r),s=i+1):(this.moveItem(e,r,a),s++)}}else this.insertItem(r,a)}for(const e of n)!1===e.retained?this.deleteItem(e):e.reset()}retainItem(e,t){kt&&me("list-updates",["retain",t.key]);let{children:n}=this;H(e.memo,t.memo),H(e.value,t.value),e.retained=!0,e.index=n.length,n.push(e)}insertItem(e,t){kt&&me("list-updates",["insert",e.key]);let{opcodeMap:n,bounds:s,state:i,runtime:r,children:a}=this,{key:o}=e,l=void 0===t?this.marker:t.firstNode(),c=fn.forInitialRender(r.env,{element:s.parentElement(),nextSibling:l});i.resume(r,c).execute((t=>{t.pushUpdating();let s=t.enterItem(e);s.index=a.length,a.push(s),n.set(o,s),Ve(this,s)}))}moveItem(e,t,n){let s,i,{children:r}=this;if(H(e.memo,t.memo),H(e.value,t.value),e.retained=!0,void 0===n?Lt(e,this.marker):(s=e.lastNode().nextSibling,i=n.firstNode(),s!==i&&Lt(e,i)),e.index=r.length,r.push(e),kt){me("list-updates",[s&&s===i?"move-retain":"move",t.key])}}deleteItem(e){kt&&me("list-updates",["delete",e.key]),De(e),Dt(e),this.opcodeMap.delete(e.key)}}class Gi{current=0;constructor(e,t){this.ops=e,this.exceptionHandler=t}goto(e){this.current=e}nextStatement(){return this.ops[this.current++]}handleException(){this.exceptionHandler&&this.exceptionHandler.handleException()}}class ji{constructor(e,t,n,s){this.env=e,this.updating=t,this.bounds=n,this.drop=s,Ve(this,s),Le(this,(()=>Dt(this.bounds)))}rerender(){let{alwaysRevalidate:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{alwaysRevalidate:!1},{env:t,updating:n}=this;new Vi(t,{alwaysRevalidate:e}).execute(n,this)}parentElement(){return this.bounds.parentElement()}firstNode(){return this.bounds.firstNode()}lastNode(){return this.bounds.lastNode()}handleException(){throw"this should never happen"}}class Fi{static restore(e){return new this(e.slice(),[0,-1,e.length-1,0])}[Tt];constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;this.stack=e,this[Tt]=t,kt&&Object.seal(this)}push(e){this.stack[++this[Tt][ke]]=e}dup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Tt][ke];this.stack[++this[Tt][ke]]=this.stack[e]}copy(e,t){this.stack[t]=this.stack[e]}pop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack[this[Tt][ke]];return this[Tt][ke]-=e,t}peek(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.stack[this[Tt][ke]-e]}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Tt][Se];return this.stack[t+e]}set(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this[Tt][Se];this.stack[n+t]=e}slice(e,t){return this.stack.slice(e,t)}capture(e){let t=this[Tt][ke]+1,n=t-e;return this.stack.slice(n,t)}reset(){this.stack.length=0}toArray(){return this.stack.slice(this[Tt][Se],this[Tt][ke]+1)}}class zi{scope=new Y;dynamicScope=new Y;updating=new Y;cache=new Y;list=new Y}class Wi{[Nt]=new zi;[_t];destructor;[Ct]=new Y;[Bt];[At];[xt];get stack(){return this[xt].stack}get pc(){return this[xt].fetchRegister(ye)}s0=null;s1=null;t0=null;t1=null;v0=null;fetch(e){let t=this.fetchValue(e);this.stack.push(t)}load(e){let t=this.stack.pop();this.loadValue(e,t)}fetchValue(e){if(Me(e))return this[xt].fetchRegister(e);switch(e){case Oe:return this.s0;case Re:return this.s1;case xe:return this.t0;case Ce:return this.t1;case Te:return this.v0}}loadValue(e,t){switch(Me(e)&&this[xt].loadRegister(e,t),e){case Oe:this.s0=t;break;case Re:this.s1=t;break;case xe:this.t0=t;break;case Ce:this.t1=t;break;case Te:this.v0=t}}pushFrame(){this[xt].pushFrame()}popFrame(){this[xt].popFrame()}goto(e){this[xt].goto(e)}call(e){this[xt].call(e)}returnTo(e){this[xt].returnTo(e)}return(){this[xt].return()}constructor(e,t,n,s){let{pc:i,scope:r,dynamicScope:a,stack:o}=t;this.runtime=e,this.elementStack=n,this.context=s,We(),this.resume=Ji(s);let l=Fi.restore(o);J("number"==typeof i,"pc is a number"),l[Tt][ye]=i,l[Tt][ke]=o.length-1,l[Tt][Se]=-1,this[_t]=this.program.heap,this[Bt]=this.program.constants,this.elementStack=n,this[Nt].scope.push(r),this[Nt].dynamicScope.push(a),this[At]=new ms,this[xt]=new Di(l,this[_t],e.program,{debugBefore:e=>wn.debugBefore(this,e),debugAfter:e=>{wn.debugAfter(this,e)}},l[Tt]),this.destructor={},this[Ct].push(this.destructor)}static initial(e,t,n){let{handle:s,self:i,dynamicScope:r,treeBuilder:a,numSymbols:o,owner:l}=n,c=Et.root(i,o,l),u=Yi(e.program.heap.getaddr(s),c,r),d=Ji(t)(e,u,a);return d.pushUpdating(),d}static empty(e,t,n){let{handle:s,treeBuilder:i,dynamicScope:r,owner:a}=t,o=Ji(n)(e,Yi(e.program.heap.getaddr(s),Et.root(N,0,a),r),i);return o.pushUpdating(),o}resume;compile(e){return fe(e.compile(this.context))}get program(){return this.runtime.program}get env(){return this.runtime.env}captureState(e){return{pc:arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[xt].fetchRegister(ye),scope:this.scope(),dynamicScope:this.dynamicScope(),stack:this.stack.capture(e)}}capture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[xt].fetchRegister(ye);return new Ui(this.captureState(e,t),this.resume)}beginCacheGroup(e){let t=this.updating(),n=new Vn;t.push(n),t.push(new Un(e)),this[Nt].cache.push(n),Ye(e)}commitCacheGroup(){let e=this.updating(),t=F(this[Nt].cache.pop(),"VM BUG: Expected a cache group"),n=Je();e.push(new In(t)),t.finalize(n,e.length)}enter(e){let t=this.capture(e),n=this.elements().pushUpdatableBlock(),s=new $i(t,this.runtime,n,[]);this.didEnter(s)}enterItem(e){let{key:t,value:n,memo:s}=e,{stack:i}=this,r=P(n),a=P(s);i.push(r),i.push(a);let o=this.capture(2),l=this.elements().pushUpdatableBlock(),c=new Hi(o,this.runtime,l,t,a,r);return this.didEnter(c),c}registerItem(e){this.listBlock().initializeChild(e)}enterList(e,t){let n=[],s=this[xt].target(t),i=this.capture(0,s),r=this.elements().pushBlockList(n),a=new Pi(i,this.runtime,r,n,e);this[Nt].list.push(a),this.didEnter(a)}didEnter(e){this.associateDestroyable(e),this[Ct].push(e),this.updateWith(e),this.pushUpdating(e.children)}exit(){this[Ct].pop(),this.elements().popBlock(),this.popUpdating()}exitList(){this.exit(),this[Nt].list.pop()}pushUpdating(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this[Nt].updating.push(e)}popUpdating(){return F(this[Nt].updating.pop(),"can't pop an empty stack")}updateWith(e){this.updating().push(e)}listBlock(){return F(this[Nt].list.current,"expected a list block")}associateDestroyable(e){let t=F(this[Ct].current,"Expected destructor parent");Ve(t,e)}tryUpdating(){return this[Nt].updating.current}updating(){return F(this[Nt].updating.current,"expected updating opcode on the updating opcode stack")}elements(){return this.elementStack}scope(){return F(this[Nt].scope.current,"expected scope on the scope stack")}dynamicScope(){return F(this[Nt].dynamicScope.current,"expected dynamic scope on the dynamic scope stack")}pushChildScope(){this[Nt].scope.push(this.scope().child())}pushDynamicScope(){let e=this.dynamicScope().child();return this[Nt].dynamicScope.push(e),e}pushRootScope(e,t){let n=Et.sized(e,t);return this[Nt].scope.push(n),n}pushScope(e){this[Nt].scope.push(e)}popScope(){this[Nt].scope.pop()}popDynamicScope(){this[Nt].dynamicScope.pop()}getOwner(){return this.scope().owner}getSelf(){return this.scope().getSelf()}referenceForSymbol(e){return this.scope().getSymbol(e)}execute(e){{let t=!0;try{let n=this._execute(e);return t=!1,n}finally{if(t){let e=this.elements();for(;e.hasBlocks;)e.popBlock();console.error(`\n\nError occurred:\n\n${lt()}\n\n`)}}}}_execute(e){let t;wt&&K.log(`EXECUTING FROM ${this[xt].fetchRegister(ye)}`),e&&e(this);do{t=this.next()}while(!t.done);return t.value}next(){let e,{env:t,elementStack:n}=this,s=this[xt].nextStatement();return null!==s?(this[xt].evaluateOuter(s,this),e={done:!1,value:null}):(this.stack.reset(),e={done:!0,value:new ji(t,this.popUpdating(),n.popBlock(),this.destructor)}),e}bindDynamicScope(e){let t=this.dynamicScope();for(const n of ge(e))t.set(n,this.stack.pop())}}function Yi(e,t,n){return{pc:e,scope:t,dynamicScope:n,stack:[]}}function Ji(e){return(t,n,s)=>new Wi(t,n,s,e)}class qi{constructor(e){this.vm=e}next(){return this.vm.next()}sync(){return ot.runInTrackingTransaction((()=>this.vm.execute()),"- While rendering:")}}function Ki(e,t){let n;return hi(e,(()=>n=t.sync())),n}function Xi(e,t,n,s,i,r){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new St,o=fe(r.compile(t)),l=r.symbolTable.symbols.length,c=Wi.initial(e,t,{self:s,dynamicScope:a,treeBuilder:i,handle:o,numSymbols:l,owner:n});return new qi(c)}function Qi(e,t,n,s,i){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new St;return function(e,t,n,s,i){const r=Object.keys(i).map((e=>[e,i[e]])),a=["main","else","attrs"],o=r.map((e=>{let[t]=e;return`@${t}`}));let l=e[Bt].component(s,n);e.pushFrame();for(let t=0;t<3*a.length;t++)e.stack.push(null);e.stack.push(null),r.forEach((t=>{let[,n]=t;e.stack.push(n)})),e[At].setup(e.stack,o,a,0,!0);const c=F(l.compilable,"BUG: Expected the root component rendered with renderComponent to have an associated template, set with setComponentTemplate"),u={handle:fe(c.compile(t)),symbolTable:c.symbolTable};return e.stack.push(e[At]),e.stack.push(u),e.stack.push(l),new qi(e)}(Wi.empty(e,{treeBuilder:t,handle:n.stdlib.main,dynamicScope:a,owner:s},n),n,s,i,function(e){const t=B(e,"args");return Object.keys(e).reduce(((e,n)=>(e[n]=U(t,n),e)),{})}(r))}const Zi="%+b:0%";function er(e){return e.nodeValue===Zi}class tr extends Mt{candidate=null;openBlockDepth;injectedOmittedNode=!1;constructor(e,t,n){super(e,t),this.startingBlockDepth=n,this.openBlockDepth=n-1}}class nr extends fn{unmatchedAttributes=null;blockDepth=0;startingBlockOffset;constructor(e,t,n){if(super(e,t,n),n)throw new Error("Rehydration with nextSibling not supported");let s=this.currentCursor.element.firstChild;for(;null!==s&&!sr(s);)s=s.nextSibling;J(s,"Must have opening comment for rehydration."),this.candidate=s;const i=rr(s);if(0!==i){const e=i-1,t=this.dom.createComment(`%+b:${e}%`);s.parentNode.insertBefore(t,this.candidate);let n=s.nextSibling;for(;null!==n&&(!ir(n)||rr(n)!==i);)n=n.nextSibling;J(n,"Must have closing comment for starting block comment");const r=this.dom.createComment(`%-b:${e}%`);s.parentNode.insertBefore(r,n.nextSibling),this.candidate=t,this.startingBlockOffset=e}else this.startingBlockOffset=0}get currentCursor(){return this[mn].current}get candidate(){return this.currentCursor?this.currentCursor.candidate:null}set candidate(e){this.currentCursor.candidate=e}disableRehydration(e){const t=this.currentCursor;t.candidate=null,t.nextSibling=e}enableRehydration(e){const t=this.currentCursor;t.candidate=e,t.nextSibling=null}pushElement(e){const t=new tr(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,this.blockDepth||0);null!==this.candidate&&(t.candidate=e.firstChild,this.candidate=e.nextSibling),this[mn].push(t)}clearMismatch(e){let t=e;const n=this.currentCursor;if(null!==n){const e=n.openBlockDepth;if(e>=n.startingBlockDepth)for(;t;){if(ir(t)){if(e>=ar(t,this.startingBlockOffset))break}t=this.remove(t)}else for(;null!==t;)t=this.remove(t);this.disableRehydration(t)}}__openBlock(){const{currentCursor:e}=this;if(null===e)return;const t=this.blockDepth;this.blockDepth++;const{candidate:n}=e;if(null===n)return;const{tagName:s}=e.element;sr(n)&&ar(n,this.startingBlockOffset)===t?(this.candidate=this.remove(n),e.openBlockDepth=t):"TITLE"!==s&&"SCRIPT"!==s&&"STYLE"!==s&&this.clearMismatch(n)}__closeBlock(){const{currentCursor:e}=this;if(null===e)return;const t=e.openBlockDepth;this.blockDepth--;const{candidate:n}=e;let s=!1;if(null!==n)if(s=!0,ir(n)&&ar(n,this.startingBlockOffset)===t){const t=this.remove(n);this.candidate=t,e.openBlockDepth--}else this.clearMismatch(n),s=!1;if(!1===s){const t=e.nextSibling;if(null!==t&&ir(t)&&ar(t,this.startingBlockOffset)===this.blockDepth){const n=this.remove(t);this.enableRehydration(n),e.openBlockDepth--}}}__appendNode(e){const{candidate:t}=this;return t||super.__appendNode(e)}__appendHTML(e){const t=this.markerBounds();if(t){const e=t.firstNode(),n=t.lastNode(),s=new Rt(this.element,e.nextSibling,n.previousSibling),i=this.remove(e);return this.remove(n),null!==i&&cr(i)&&(this.candidate=this.remove(i),null!==this.candidate&&this.clearMismatch(this.candidate)),s}return super.__appendHTML(e)}remove(e){const t=F(e.parentNode,"cannot remove a detached node"),n=e.nextSibling;return t.removeChild(e),n}markerBounds(){const e=this.candidate;if(e&&lr(e)){const t=e;let n=F(t.nextSibling,"BUG: serialization markers must be paired");for(;n&&!lr(n);)n=F(n.nextSibling,"BUG: serialization markers must be paired");return new Rt(this.element,t,n)}return null}__appendText(e){const{candidate:t}=this;return t?3===t.nodeType?(t.nodeValue!==e&&(t.nodeValue=e),this.candidate=t.nextSibling,t):function(e){return 8===e.nodeType&&"%|%"===e.nodeValue}(t)||cr(t)&&""===e?(this.candidate=this.remove(t),this.__appendText(e)):(this.clearMismatch(t),super.__appendText(e)):super.__appendText(e)}__appendComment(e){const t=this.candidate;return t&&8===t.nodeType?(t.nodeValue!==e&&(t.nodeValue=e),this.candidate=t.nextSibling,t):(t&&this.clearMismatch(t),super.__appendComment(e))}__openElement(e){const t=this.candidate;if(t&&or(t)&&function(e,t){if(e.namespaceURI===z)return e.tagName===t;return e.tagName===t.toUpperCase()}(t,e))return this.unmatchedAttributes=[].slice.call(t.attributes),t;if(t){if(or(t)&&"TBODY"===t.tagName)return this.pushElement(t,null),this.currentCursor.injectedOmittedNode=!0,this.__openElement(e);this.clearMismatch(t)}return super.__openElement(e)}__setAttribute(e,t,n){const s=this.unmatchedAttributes;if(s){const n=ur(s,e);if(n)return n.value!==t&&(n.value=t),void s.splice(s.indexOf(n),1)}return super.__setAttribute(e,t,n)}__setProperty(e,t){const n=this.unmatchedAttributes;if(n){const s=ur(n,e);if(s)return s.value!==t&&(s.value=t),void n.splice(n.indexOf(s),1)}return super.__setProperty(e,t)}__flushElement(e,t){const{unmatchedAttributes:n}=this;if(n){for(const e of n)this.constructing.removeAttribute(e.name);this.unmatchedAttributes=null}else super.__flushElement(e,t)}willCloseElement(){const{candidate:e,currentCursor:t}=this;null!==e&&this.clearMismatch(e),t&&t.injectedOmittedNode&&this.popElement(),super.willCloseElement()}getMarker(e,t){const n=e.querySelector(`script[glmr="${t}"]`);return n?de(n):null}__pushRemoteElement(e,t,n){const s=this.getMarker(W(e,"HTML"),t);if(J(!s||s.parentNode===e,"expected remote element marker's parent node to match remote element"),void 0===n){for(;null!==e.firstChild&&e.firstChild!==s;)this.remove(e.firstChild);n=null}const i=new tr(e,null,this.blockDepth);this[mn].push(i),null===s?this.disableRehydration(n):this.candidate=this.remove(s);const r=new bn(e);return this.pushLiveBlock(r,!0)}didAppendBounds(e){if(super.didAppendBounds(e),this.candidate){const t=e.lastNode();this.candidate=t&&t.nextSibling}return e}}function sr(e){return e.nodeType===be&&0===e.nodeValue.lastIndexOf("%+b:",0)}function ir(e){return e.nodeType===be&&0===e.nodeValue.lastIndexOf("%-b:",0)}function rr(e){return parseInt(e.nodeValue.slice(4),10)}function ar(e,t){return rr(e)-t}function or(e){return 1===e.nodeType}function lr(e){return 8===e.nodeType&&"%glmr%"===e.nodeValue}function cr(e){return 8===e.nodeType&&"% %"===e.nodeValue}function ur(e,t){for(const n of e)if(n.name===t)return n}function dr(e,t){return nr.forInitialRender(e,t)}export{Rt as ConcreteBounds,An as CurriedValue,Mt as CursorImpl,ii as DOMChanges,Qs as DOMTreeConstruction,sn as DynamicAttribute,St as DynamicScopeImpl,_s as EMPTY_ARGS,Ns as EMPTY_NAMED,Ts as EMPTY_POSITIONAL,ui as EnvironmentImpl,ni as IDOMChanges,Wi as LowLevelVM,fn as NewElementBuilder,Et as PartialScopeImpl,nr as RehydrateBuilder,bn as RemoteLiveBlock,Zi as SERIALIZATION_FIRST_NODE_STRING,rn as SimpleDynamicAttribute,Gs as TEMPLATE_ONLY_COMPONENT_MANAGER,js as TemplateOnlyComponent,Ps as TemplateOnlyComponentManager,vn as UpdatableBlockImpl,Vi as UpdatingVM,mi as array,Dt as clear,kn as clientBuilder,gi as concat,Ss as createCapturedArgs,Rn as curry,tn as dynamicAttribute,vi as fn,ki as get,Si as hash,hi as inTransaction,Ni as invokeHelper,er as isSerializationFirstNode,ti as isWhitespace,Pt as normalizeProperty,Li as on,dr as rehydrationBuilder,Cs as reifyArgs,Es as reifyNamed,xs as reifyPositional,Qi as renderComponent,Xi as renderMain,Ki as renderSync,Is as resetDebuggerCallback,di as runtimeContext,Us as setDebuggerCallback,Fs as templateOnlyComponent};
//# sourceMappingURL=index.js.map
